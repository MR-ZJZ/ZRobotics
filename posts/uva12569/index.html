<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>UVa12569 | SonnyCalcr&#39;s Blog</title>
<meta name="keywords" content="Bilibili, ç®—æ³•ç«èµ›, UVa, ç®—æ³•ç«èµ›å…¥é—¨ç»å…¸, BFS">
<meta name="description" content="UVa12569 è§£é¢˜æ€è·¯åŠä»£ç è§£æ">
<meta name="author" content="Sonny Calcr">
<link rel="canonical" href="http://localhost:1313/posts/uva12569/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.31606b01ae31539001706d41fc833c993b1758dbed2a9d814f4563b7298aa9f6.css" integrity="sha256-MWBrAa4xU5ABcG1B/IM8mTsXWNvtKp2BT0VjtymKqfY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon.png">
<link rel="mask-icon" href="http://localhost:1313/favicon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/posts/uva12569/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
<script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>
<meta property="og:url" content="http://localhost:1313/posts/uva12569/">
  <meta property="og:site_name" content="SonnyCalcr&#39;s Blog">
  <meta property="og:title" content="UVa12569">
  <meta property="og:description" content="UVa12569 è§£é¢˜æ€è·¯åŠä»£ç è§£æ">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-08-21T23:56:38+08:00">
    <meta property="article:modified_time" content="2024-08-21T23:56:38+08:00">
    <meta property="article:tag" content="Bilibili">
    <meta property="article:tag" content="ç®—æ³•ç«èµ›">
    <meta property="article:tag" content="UVa">
    <meta property="article:tag" content="ç®—æ³•ç«èµ›å…¥é—¨ç»å…¸">
    <meta property="article:tag" content="BFS">
      <meta property="og:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.postimg.cc/7hwBy7VS/calcr.png">
<meta name="twitter:title" content="UVa12569">
<meta name="twitter:description" content="UVa12569 è§£é¢˜æ€è·¯åŠä»£ç è§£æ">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "UVa12569",
      "item": "http://localhost:1313/posts/uva12569/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "UVa12569",
  "name": "UVa12569",
  "description": "UVa12569 è§£é¢˜æ€è·¯åŠä»£ç è§£æ",
  "keywords": [
    "Bilibili", "ç®—æ³•ç«èµ›", "UVa", "ç®—æ³•ç«èµ›å…¥é—¨ç»å…¸", "BFS"
  ],
  "articleBody": "å‰è¨€ é¦–å…ˆï¼Œå»ºè®®å¤§å®¶è¯»ä¸€ä¸‹åŸé¢˜ç›®ï¼Œé¢˜ç›®çš„å†…å®¹è¿™é‡Œå°±ä¸æ”¾äº†ï¼Œå¤§å®¶å¯ä»¥åˆ°è¿™ä¸ªåœ°å€å»ä¸‹è½½: https://vjudge.net/problem/UVA-12569ï¼Œæœ‰äº›äººå¯èƒ½è¯´è‹±æ–‡ä¸å¤ªå¥½ï¼Œé‚£ä¹ˆï¼Œä¹Ÿæ²¡å…³ç³»ï¼Œé™¤äº†æŸ¥å­—å…¸ï¼Œç°åœ¨è¿˜å¯ä»¥ä½¿ç”¨è¿™ä¸ªç¿»è¯‘æ’ä»¶ï¼šæ²‰æµ¸å¼ç¿»è¯‘ï¼Œæ€»ä¹‹ï¼Œç°åœ¨è‹±è¯­è¯­è¨€å±‚é¢çš„é—®é¢˜æ˜¯ä¸ä¼šæœ‰é—®é¢˜çš„ã€‚\nä¸ºä»€ä¹ˆæˆ‘å»ºè®®å¤§å®¶è¯»åŸé¢˜ç›®å‘¢ï¼Ÿè™½ç„¶æˆ‘ä»¬å¤§å®¶æ¥è§¦åˆ°è¿™ä¸ªé¢˜ç›®å¯èƒ½éƒ½æ˜¯é€šè¿‡åˆ˜æ±ä½³çš„è¿™æœ¬ã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸ã€‹æ‰é€‰æ‹©å»çœ‹çš„ï¼Œä½†æ˜¯ï¼Œä¹¦ä¸­ç»™å‡ºçš„æè¿°éƒ½æ˜¯å¾ˆç•¥çš„ï¼Œç®€å•è®²ä¸€ç‚¹ï¼Œé¢˜ç›®å¾ˆé‡è¦çš„è¾“å…¥å’Œè¾“å‡ºæ ·ä¾‹æ•°æ®ï¼Œä¹¦ä¸Šä¸€èˆ¬éƒ½æ˜¯æ²¡æœ‰çš„ï¼Œå…¶ä»–çš„ç»†èŠ‚æ›´ä¸å¿…è¯´ã€‚å¤§æ¦‚å°±è¿™æ ·ã€‚\nç„¶åï¼Œæˆ‘ä»¬æ¥è¯¦ç»†ç ”ç©¶ä¸€ä¸‹ UVa12569 è¿™é“é¢˜çš„æ€è·¯å’Œè§£æã€‚\nè¿™é“é¢˜æ•´ä½“çš„æ€è·¯æ˜¯ BFSã€‚ç„¶åä»£ç å‚è€ƒ(å¯èƒ½æœ‰æˆ‘çš„å¾®å°è°ƒæ•´)çš„æ˜¯ã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸-ä¹ é¢˜ä¸è§£ç­”ã€‹çš„é…å¥—ä»£ç ï¼ŒGitHub åœ°å€ä¸ºï¼šhttps://github.com/sukhoeing/aoapc-bac2nd-keysã€‚\næ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´å¤šçš„æµ‹è¯•æ•°æ®ï¼Œè¿™ä¸ª udebug çš„ç½‘ç«™ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ï¼šhttps://www.udebug.comã€‚æœ¬é¢˜çš„æµ‹è¯•æ•°æ®åœ°å€ä¸ºï¼šhttps://www.udebug.com/UVa/12569ã€‚\nåŒæ—¶ï¼Œæˆ‘çš„ä»£ç æ‰˜ç®¡åœ¨äº†è¿™ä¸ªåœ°å€ï¼šhttps://github.com/sonnycalcr/aoapc-homeworkã€‚\né¦–å…ˆï¼Œè¿™é“é¢˜å¾ˆå¤šäººå¯èƒ½è§‰å¾—ç®€å•ï¼Œæˆ‘è¯´ä¸€ä¸‹æˆ‘çš„è§‚ç‚¹ï¼šå¯¹äºåˆå­¦è€…æˆ–è€…ç®—æ³•åˆé˜¶çš„åŒå­¦æ¥è®²ï¼Œè¿™é“é¢˜è¿˜æ˜¯æœ‰å¾ˆå¤šå€¼å¾—å­¦ä¹ çš„éƒ¨åˆ†çš„ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘æŒ‘ä¸€äº›å…³é”®çš„ä»£ç è®²ä¸€ä¸‹ï¼Œæ›´è¯¦ç»†çš„è§£é‡Šåœ¨ä»£ç çš„æ³¨é‡Šé‡Œé¢ã€‚\næ³¨æ„ï¼Œåœ¨å…·ä½“çœ‹/å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªç‚¹ï¼Œé¢˜ç›®ä¸­çš„ç¼–å·æ˜¯ä» 1 å¼€å§‹é€’å¢çš„ï¼Œè€Œä¸‹é¢æˆ‘ä»¬çš„ç¨‹åºéƒ½æ˜¯ä» 0 å¼€å§‹é€’å¢çš„ã€‚\nPart1 å…ˆçœ‹æ•°æ®ç»“æ„ï¼Œä¸€ä¸ªæ˜¯ Nodeï¼Œ\n1struct Node { 2 int from, to; 3 Node *next; 4}; Node æ˜¯è¡¨ç¤ºè·¯å¾„çš„é“¾è¡¨èŠ‚ç‚¹ï¼Œto è¡¨ç¤ºçš„æ˜¯å½“å‰çš„èŠ‚ç‚¹ï¼Œfrom æ˜¯ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸»è¦æ˜¯ç”¨æ¥åœ¨ State ç±»å‹ä¸­è¡¨ç¤º pathï¼Œä¹Ÿå°±æ˜¯å½“å‰çš„çŠ¶æ€æ˜¯ç”±ä¸Šä¸€ä¸ªçŠ¶æ€ä» from ç§»åŠ¨äº†æœºå™¨äºº/çŸ³å¤´åˆ° to è€Œè½¬åŒ–è¿‡æ¥çš„ã€‚\nPart2 å†çœ‹ Stateï¼Œ\n1struct State { 2 Node *path; // è·¯å¾„ 3 int g; // çŠ¶æ€å‹ç¼©ï¼Œå‰ 4 ä½(å½“ç„¶æ˜¯ä»å³å¾€å·¦)è¡¨ç¤ºæœºå™¨äººğŸ¤–ä½ç½®çš„ç¼–å·ï¼Œå› ä¸ºèŠ‚ç‚¹æ•° n çš„èŒƒå›´æ˜¯ï¼š4 \u003c= n \u003c= 15ï¼Œåé¢ 16 ä½çš„æ¯ä¸€ä½ç”¨æ¥è¡¨ç¤ºä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ï¼Œæ¯”å¦‚ï¼Œ(2 + 4) è¿™ä¸ª bit ä½ä¸º 1ï¼Œå°±è¡¨ç¤ºç¼–å·ä¸º 2 çš„ä½ç½®ä¸Šæœ‰çŸ³å¤´ 4 int len; // è·¯å¾„é•¿åº¦ï¼Œåˆ°äº†å½“å‰çŠ¶æ€å·²ç»ç»å†çš„é•¿åº¦ 5 State(int gi = 0, int li = 0, Node *pn = NULL) : g(gi), len(li), path(pn) {} 6 inline bool operator[](size_t i) const { return g \u0026 (1 \u003c\u003c (i + 4)); } // ä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ï¼Œå‰ 4 ä½è¢«æœºå™¨äººå æ®äº†ï¼Œå¾€åçš„ä½æ‰èƒ½ç”¨æ¥è¡¨ç¤ºçŸ³å¤´ 7 inline void setRock(size_t i, bool val = true) { // è®¾ç½®ä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ 8 if (val) 9 g |= 1 \u003c\u003c (i + 4); // ä½æˆ–æ“ä½œæ¥æŠŠç¬¬(i + 4)ä½æ¥ç½® 1 10 else 11 g \u0026= ~(1 \u003c\u003c (i + 4)); // å…ˆå–åï¼Œå†ç”¨ä¸æ“ä½œæ¥æŠŠç¬¬(i + 4)ä½æ¥ç½® 0 12 } 13 // æœºå™¨äººçš„ä½ç½®æ“ä½œ 14 inline int getP() const { return g \u0026 15; } // ä¸ 1111(äºŒè¿›åˆ¶) è¿›è¡Œä¸æ“ä½œï¼Œå–å‡ºå‰ 4 ä½çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æœºå™¨äººçš„ä½ç½® 15 inline void setP(int p) { g = ((g \u003e\u003e 4) \u003c\u003c 4) | p; } // è®¾ç½®æœºå™¨äººçš„ä½ç½®ï¼Œè¿™é‡Œå…ˆå³ç§»å†å·¦ç§» 4 ä½æ¸…é™¤åŸæœ‰çš„æ•°æ® 16}; æ‰€è°“çš„ Stateï¼Œå°±æ˜¯å½“å‰çš„å±€é¢ï¼Œç”±ä»¥ä¸‹å‡ ä¸ªç»´åº¦çš„æ•°æ®æ„æˆï¼Œ\npath æ˜¯è·¯å¾„ï¼Œä¸Šé¢è®²è¿‡äº†ï¼Œå…¶ä¸­ä¿å­˜äº†ä¸Šä¸€ä¸ªçŠ¶æ€è½¬å˜åˆ°å½“å‰çŠ¶æ€æ˜¯ç§»åŠ¨äº†å“ªä¸€ä¸ªç¼–å·ï¼Œç„¶ååˆæ˜¯ç§»åŠ¨åˆ°äº†å“ªä¸€ä¸ªç¼–å·ï¼ŒåŒæ—¶ next æŒ‡å‘äº†ä¸Šä¸€æ¬¡çŠ¶æ€çš„ pathã€‚ g ä»£è¡¨äº†æ•´ä½“çš„çŠ¶æ€ï¼Œå…¶ä¸­ï¼Œå‰ 4 ä½(åˆ†åˆ«æ˜¯ï¼š0, 1, 2, 3)äºŒè¿›åˆ¶å€¼ä½œä¸ºä¸€ä¸ªæ•´ä½“å¯ä»¥è½¬åŒ–æˆåè¿›åˆ¶ï¼Œè¡¨ç¤ºäº†å½“å‰æœºå™¨äººåœ¨å“ªä¸ªç¼–å·çš„ä½ç½®ï¼›ç„¶åå†å¾€å·¦å– 16 ä½äºŒè¿›åˆ¶ bit ä½ï¼Œå…¶ä¸­æ¯ä¸€ä½éƒ½ä»£è¡¨äº†ä¸€ä¸ªç¼–å·ï¼Œæ¯”å¦‚ï¼Œ0 å·ä½ç½®çš„ bit ä½æ˜¯ (0 + 4)ï¼Œä¹Ÿå°±æ˜¯ç¬¬ 4 ä½ï¼Œå¦‚æœè¿™ä¸€ä½ä¸º 1ï¼Œåˆ™è¡¨ç¤ºæ ‘ä¸­ç¼–å·ä¸º 0 çš„ä½ç½®ä¸Šæœ‰çŸ³å¤´ï¼Œåä¹‹åˆ™æ²¡æœ‰ï¼Œå…¶å®ƒçš„ç¼–å·ä¾æ­¤ç±»æ¨ã€‚ len è¡¨ç¤ºä»æœ€åŸå§‹çš„çŠ¶æ€æ¥åˆ°äº†å½“å‰çš„çŠ¶æ€ï¼Œä¸€å…±èµ°äº†å¤šå°‘æ­¥ã€‚ ç†è§£äº†ä¸Šé¢çš„å‡ ä¸ªæˆå‘˜å˜é‡ï¼Œå°±ä¸éš¾ç†è§£ä¹‹åçš„å‡ ä¸ªæˆå‘˜å‡½æ•°äº†ã€‚\nPart3 æˆ‘ä»¬å†çœ‹è¾“å‡ºè¿ç®—ç¬¦çš„é‡è½½ï¼Œ\n1// ä¸€ä¸ªé€’å½’çš„è¾“å‡ºï¼Œå› ä¸º tryMove ä¿è¯äº†æœ€ç»ˆåˆ°è¾¾ç»ˆç‚¹æ—¶çš„çŠ¶æ€ä¸­çš„ path æ˜¯é€’å½’åœ°å¾€å‰æŒ‡çš„ 2ostream \u0026operator\u003c\u003c(ostream \u0026os, Node *p) { 3 if (p == NULL) 4 return os; 5 os \u003c\u003c p-\u003enext \u003c\u003c p-\u003efrom + 1 \u003c\u003c \" \" \u003c\u003c p-\u003eto + 1 \u003c\u003c endl; // è¿™é‡Œè¦æŠŠ from å’Œ to åˆ†åˆ«åŠ  1 æ¥æ˜ å°„æˆé¢˜ç›®ä¸­çš„ä» 1 å¼€å§‹çš„åºå· 6 return os; 7} è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„ï¼Œå› ä¸º Node å®é™…ä¸Šæ˜¯ç”¨æ¥è¡¨ç¤º State ä¸­çš„ path çš„ï¼Œæ‰€ä»¥ï¼Œå¹¶ä¸”ï¼Œæˆ‘ä»¬æ˜¯åˆ°äº†æœ€åæˆåŠŸåˆ°è¾¾ç»ˆç‚¹æ—¶(çœ‹ä»£ç  109 è¡Œ)ç›´æ¥æ‰“å°æœ€ç»ˆçš„é‚£ä¸ª State çš„ path çš„ï¼Œè€Œæ¯ä¸€ä¸ª path æŒ‡å‘çš„åˆæ˜¯ä¸Šä¸€ä¸ª State çš„ pathï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªè¾“å‡ºé‡è½½å°±è¾¾åˆ°äº†è¾“å‡ºä»åˆå§‹çš„çŠ¶æ€ç§»åŠ¨åˆ°æœ€ç»ˆç›®æ ‡çš„å…¨éƒ¨è·¯å¾„çš„ç›®çš„ã€‚\nPart4 ç„¶åï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å°è¯•ç§»åŠ¨æœºå™¨äººæˆ–è€…çŸ³å¤´çš„æ€è·¯ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå†æ¥çœ‹ä¸€ä¸‹å…¨å±€å˜é‡ï¼Œ\n1const int MAXN = 16; // èŠ‚ç‚¹çš„æœ€å¤§æ•°é‡æ˜¯ 16ï¼Œæ ¹æ®é¢˜ç›®ä¸­çš„æ¡ä»¶å¾—æ¥ 2vector\u003cint\u003e G[MAXN]; // å›¾çš„é‚»æ¥çŸ©é˜µè¡¨ç¤ºï¼Œé¢˜ç›®ä¸­ç®€åŒ–æˆäº†æ ‘(æ— ç¯å›¾) 3MemPool\u003cNode\u003e pool; // é“¾è¡¨èŠ‚ç‚¹åˆ†é…ï¼Œç”¨ MemPool æ¯”è¾ƒå¥½ç®¡ç†å†…å­˜ 4// n: é¡¶ç‚¹æ•°ï¼›m: éšœç¢ç‰©(çŸ³å¤´)æ•°é‡ï¼›S: æºï¼Œå³æœºå™¨äººçš„èµ·ç‚¹ä½ç½®ï¼›T: ç›®æ ‡ä½ç½® 5// O: æ¯ä¸€ä¸ªçŸ³å¤´çš„ä½ç½®ç¼–å· 6// VIS: è¡¨ç¤ºæŸä¸ªä½ç½®æ˜¯å¦å·²ç» visited è¿‡äº† 7int n, m, S, T, O[MAXN], VIS[1 \u003c\u003c 19]; è¿™ä¸ªæ³¨é‡Šæ¯”è¾ƒæ¸…æ™°äº†ï¼Œå°±ä¸å¤šè®²äº†ã€‚ç„¶åï¼Œè®©æˆ‘ä»¬è¿›å…¥æ­£é¢˜ï¼Œæ¥çœ‹ tryMove è¿™ä¸ªå‡½æ•°ï¼Œ\n1// å°è¯•ç§»åŠ¨åœ¨ç‚¹ from ä¸Šçš„ç‰©ä½“(æœºå™¨äººæˆ–è€…çŸ³å¤´) 2void tryMove(const State \u0026s, int from, queue\u003cState\u003e \u0026q) { 3 int rp = s.getP(); // è·å–å½“å‰çŠ¶æ€ä¸‹æœºå™¨äººçš„ä½ç½®ç¼–å· 4 for (auto to : G[from]) { 5 if ((to == rp) || s[to]) // to å’Œå½“å‰çŠ¶æ€çš„æœºå™¨äººä½ç½®é‡åˆæˆ–è€… to çš„ä½ç½®ä¸Šæœ‰æœºå™¨äºº 6 continue; 7 int ng = s.g; 8 if (from == rp) 9 ng = ((s.g \u003e\u003e 4) \u003c\u003c 4) | to; // æŠŠ s.g çš„å‰ 4 ä½ç½®æˆ to è¿™ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯ç§»åŠ¨æœºå™¨äººåˆ° to çš„ä½ç½® 10 else 11 ng ^= (1 \u003c\u003c (from + 4)), ng ^= (1 \u003c\u003c (to + 4)); // æŠŠ ng çš„ from å¯¹åº”çš„ bit ä½ç½® 0ï¼Œç„¶åæŠŠ to å¯¹åº”çš„ bit ä½ç½® 1ï¼Œä¹Ÿå°±æ˜¯æŠŠçŸ³å¤´ä» from ä½ç½®ç§»åŠ¨åˆ° to è¿™ä¸ªä½ç½® 12 if (VIS[ng]) 13 continue; // æ–°çš„çŠ¶æ€å·²ç»è®¿é—®è¿‡ 14 VIS[ng] = 1; // æ ‡è®°è®¿é—® 15 // è¿™é‡Œæ„å»ºçš„æ–° State çš„ newNode çš„ next å±æ€§æŒ‡å‘çš„æ˜¯ç§»åŠ¨å‰çš„ State çš„ path Node 16 q.push(State(ng, s.len + 1, newNode(s.path, from, to))); 17 } 18} å› ä¸º G æ˜¯é‚»æ¥çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹æ¥è¿›è¡Œ for å¾ªç¯ï¼Œéå†ä¸ from é¡¶ç‚¹æ‰€é‚»æ¥çš„å‡ ä¸ªé¡¶ç‚¹ï¼Œå°è¯•å»ç§»åŠ¨åˆ°è¿™äº›ä½ç½®ï¼Œç„¶åå°±æ˜¯ä¸€ç³»åˆ—çš„ç»†èŠ‚å¤„ç†ï¼Œçœ‹æ³¨é‡Šæ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚\nPart5 ä¸‹é¢æˆ‘ä»¬æ¥çœ‹æœ€ç»ˆçš„æ ¸å¿ƒçš„ä»£ç ï¼Œ\n1// bfs 2void solve() { 3 // å®šä¹‰å¹¶åˆå§‹åŒ–åŸå§‹çš„çŠ¶æ€ 4 State s; 5 _for(i, 0, m) s.setRock(O[i]); 6 s.setP(S); 7 queue\u003cState\u003e q; 8 q.push(s); 9 VIS[s.g] = 1; // æ ‡è®°å½“å‰æœºå™¨äººå’ŒçŸ³å¤´çš„çŠ¶æ€å·²ç»è¢«è®¿é—®è¿‡ 10 // bfs ä¸€å±‚ä¸€å±‚åœ°éå† 11 while (!q.empty()) { 12 const State \u0026st = q.front(); 13 int rp = st.getP(); 14 if (rp == T) { // åˆ°è¾¾ç›®çš„åœ°ï¼Œå› ä¸ºæ˜¯ bfsï¼Œæ‰€ä»¥ä¸€æ—¦åˆ°è¾¾ç›®çš„åœ°ï¼Œä¹Ÿå°±è¡¨æ˜æ˜¯æœ€çŸ­è·¯å¾„ä¹‹ä¸€ï¼Œåé¢ä¸å¯èƒ½æœ‰ç§»åŠ¨æ­¥æ•°æ›´å°‘çš„ç»“æœï¼Œæœ€å¥½çš„æƒ…å†µä¹Ÿæ˜¯èŠ±è´¹å’Œå½“å‰ä¸€æ ·çš„æ­¥æ•° 15 cout \u003c\u003c st.len \u003c\u003c endl \u003c\u003c st.path; 16 return; 17 } 18 tryMove(st, rp, q); // å°è¯•ç§»åŠ¨æœºå™¨äºº 19 _for(i, 0, n) if (st[i]) tryMove(st, i, q); // å°è¯•ç§»åŠ¨çŸ³å¤´ 20 q.pop(); 21 } 22 cout \u003c\u003c \"-1\" \u003c\u003c endl; // æ— æ³•åˆ°è¾¾ç›®çš„åœ° 23} è¿™é‡Œå°±æ˜¯ä¸€ä¸ªçº¯ç²¹çš„ bfsï¼Œæˆ‘ä»¬å®šä¹‰å¥½äº†åŸå§‹çš„çŠ¶æ€ä¹‹åï¼Œç„¶ååˆ©ç”¨é˜Ÿåˆ—è¿™ä¸ªæ•°æ®ç»“æ„ä¸€åœˆä¸€åœˆåœ°å¾€å¤–è¿›è¡Œæ³¢çº¹æ‰©æ•£æ€§åœ°éå†ï¼Œé˜Ÿåˆ—ä¸­ä»å‰å¾€åå­˜æ”¾çš„åˆ†åˆ«æ˜¯ç¬¬ 1 åœˆã€ç¬¬ 2 åœˆâ€¦çš„æ•°æ®ï¼Œè€Œä¸”é˜Ÿåˆ—æ˜¯å…ˆè¿›å…ˆå‡º(FIFO, First In First Out)ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æš´åŠ›åœ°éå†æ‰€æœ‰çš„æƒ…å†µï¼Œå¹¶ä¸”ï¼Œå¯ä»¥ä¿è¯ï¼Œä¸€æ—¦ç¬¬ä¸€æ¬¡å¾—åˆ°äº†æƒ³è¦çš„ç»“æœï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªç»“æœå°±æ˜¯æˆ‘ä»¬æœ€ç»ˆæƒ³è¦çš„ç»“æœã€‚\nå®Œæ•´çš„ä»£ç å’Œæ³¨é‡Š ä»¥ä¸Šå°±æ˜¯å…³é”®çš„ä»£ç å’Œè§£é‡Šäº†ã€‚å…¶ä»–çš„ä¸œè¥¿æ²¡ä»€ä¹ˆå¥½è®²çš„ã€‚å…³äºæ•°æ®çš„è¾“å…¥å’Œå¤„ç†ï¼Œä¸Šé¢ä¹Ÿæ²¡æœ‰ç»†è®²ï¼Œç›´æ¥çœ‹æ³¨é‡Šå³å¯ã€‚\nä¸‹é¢å°±æ˜¯å®Œæ•´çš„ä»£ç å’Œè¯¦ç»†çš„æ³¨é‡Šï¼š\n1#include 2#include 3#include 4#include 5#include 6#include 7 8#define _for(i, a, b) for (int i = (a); i \u003c (b); ++i) 9 10using namespace std; 11 12int readint() { 13 int x; 14 cin \u003e\u003e x; 15 return x; 16} 17 18template \u003ctypename T\u003e struct MemPool { 19 vector\u003cT *\u003e buf; 20 T *createNew() { 21 buf.push_back(new T()); 22 return buf.back(); 23 } 24 25 void dispose() { 26 for (int i = 0; i \u003c buf.size(); i++) 27 delete buf[i]; 28 buf.clear(); 29 } 30}; 31 32const int MAXN = 16; // èŠ‚ç‚¹çš„æœ€å¤§æ•°é‡æ˜¯ 16 33 34struct Node { // è¡¨ç¤ºè·¯å¾„çš„é“¾è¡¨èŠ‚ç‚¹ï¼Œto è¡¨ç¤ºçš„æ˜¯å½“å‰çš„èŠ‚ç‚¹ï¼Œfrom æ˜¯ä¸Šä¸€ä¸ªèŠ‚ç‚¹ 35 int from, to; 36 Node *next; 37}; 38 39struct State { 40 Node *path; // è·¯å¾„ 41 int g; // çŠ¶æ€å‹ç¼©ï¼Œå‰ 4 ä½(å½“ç„¶æ˜¯ä»å³å¾€å·¦)è¡¨ç¤ºæœºå™¨äººğŸ¤–ä½ç½®çš„ç¼–å·ï¼Œå› ä¸ºèŠ‚ç‚¹æ•° n çš„èŒƒå›´æ˜¯ï¼š4 \u003c= n \u003c= 15ï¼Œåé¢ 16 ä½çš„æ¯ä¸€ä½ç”¨æ¥è¡¨ç¤ºä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ï¼Œæ¯”å¦‚ï¼Œ(2 + 4) è¿™ä¸ª bit ä½ä¸º 1ï¼Œå°±è¡¨ç¤ºç¼–å·ä¸º 2 çš„ä½ç½®ä¸Šæœ‰çŸ³å¤´ 42 int len; // è·¯å¾„é•¿åº¦ï¼Œåˆ°äº†å½“å‰çŠ¶æ€å·²ç»ç»å†çš„é•¿åº¦ 43 State(int gi = 0, int li = 0, Node *pn = NULL) : g(gi), len(li), path(pn) {} 44 inline bool operator[](size_t i) const { return g \u0026 (1 \u003c\u003c (i + 4)); } // ä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ï¼Œå‰ 4 ä½è¢«æœºå™¨äººå æ®äº†ï¼Œå¾€åçš„ä½æ‰èƒ½ç”¨æ¥è¡¨ç¤ºçŸ³å¤´ 45 inline void setRock(size_t i, bool val = true) { // è®¾ç½®ä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ 46 if (val) 47 g |= 1 \u003c\u003c (i + 4); // ä½æˆ–æ“ä½œæ¥æŠŠç¬¬(i + 4)ä½æ¥ç½® 1 48 else 49 g \u0026= ~(1 \u003c\u003c (i + 4)); // å…ˆå–åï¼Œå†ç”¨ä¸æ“ä½œæ¥æŠŠç¬¬(i + 4)ä½æ¥ç½® 0 50 } 51 // æœºå™¨äººçš„ä½ç½®æ“ä½œ 52 inline int getP() const { return g \u0026 15; } // ä¸ 1111(äºŒè¿›åˆ¶) è¿›è¡Œä¸æ“ä½œï¼Œå–å‡ºå‰ 4 ä½çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æœºå™¨äººçš„ä½ç½® 53 inline void setP(int p) { g = ((g \u003e\u003e 4) \u003c\u003c 4) | p; } // è®¾ç½®æœºå™¨äººçš„ä½ç½®ï¼Œè¿™é‡Œå…ˆå³ç§»å†å·¦ç§» 4 ä½æ¸…é™¤åŸæœ‰çš„æ•°æ® 54}; 55 56vector\u003cint\u003e G[MAXN]; // å›¾çš„é‚»æ¥çŸ©é˜µè¡¨ç¤ºï¼Œé¢˜ç›®ä¸­ç®€åŒ–æˆäº†æ ‘(æ— ç¯å›¾) 57MemPool\u003cNode\u003e pool; // é“¾è¡¨èŠ‚ç‚¹åˆ†é…ï¼Œç”¨ MemPool æ¯”è¾ƒå¥½ç®¡ç†å†…å­˜ 58// n: é¡¶ç‚¹æ•°ï¼›m: éšœç¢ç‰©(çŸ³å¤´)æ•°é‡ï¼›S: æºï¼Œå³æœºå™¨äººçš„èµ·ç‚¹ä½ç½®ï¼›T: ç›®æ ‡ä½ç½® 59// O: æ¯ä¸€ä¸ªçŸ³å¤´çš„ä½ç½®ç¼–å· 60// VIS: è¡¨ç¤ºæŸä¸ªä½ç½®æ˜¯å¦å·²ç» visited è¿‡äº† 61int n, m, S, T, O[MAXN], VIS[1 \u003c\u003c 19]; 62Node *newNode(Node *next = NULL, int u = -1, int v = -1) { 63 Node *p = pool.createNew(); 64 p-\u003enext = next, p-\u003efrom = u, p-\u003eto = v; 65 return p; 66} 67 68// ä¸€ä¸ªé€’å½’çš„è¾“å‡ºï¼Œå› ä¸º tryMove ä¿è¯äº†æœ€ç»ˆåˆ°è¾¾ç»ˆç‚¹æ—¶çš„çŠ¶æ€ä¸­çš„ path æ˜¯é€’å½’åœ°å¾€å‰æŒ‡çš„ 69ostream \u0026operator\u003c\u003c(ostream \u0026os, Node *p) { 70 if (p == NULL) 71 return os; 72 os \u003c\u003c p-\u003enext \u003c\u003c p-\u003efrom + 1 \u003c\u003c \" \" \u003c\u003c p-\u003eto + 1 \u003c\u003c endl; // è¿™é‡Œè¦æŠŠ from å’Œ to åˆ†åˆ«åŠ  1 æ¥æ˜ å°„æˆé¢˜ç›®ä¸­çš„ä» 1 å¼€å§‹çš„åºå· 73 return os; 74} 75 76// å°è¯•ç§»åŠ¨åœ¨ç‚¹ from ä¸Šçš„ç‰©ä½“(æœºå™¨äººæˆ–è€…çŸ³å¤´) 77void tryMove(const State \u0026s, int from, queue\u003cState\u003e \u0026q) { 78 int rp = s.getP(); // è·å–å½“å‰çŠ¶æ€ä¸‹æœºå™¨äººçš„ä½ç½®ç¼–å· 79 for (auto to : G[from]) { 80 if ((to == rp) || s[to]) // to å’Œå½“å‰çŠ¶æ€çš„æœºå™¨äººä½ç½®é‡åˆæˆ–è€… to çš„ä½ç½®ä¸Šæœ‰æœºå™¨äºº 81 continue; 82 int ng = s.g; 83 if (from == rp) 84 ng = ((s.g \u003e\u003e 4) \u003c\u003c 4) | to; // æŠŠ s.g çš„å‰ 4 ä½ç½®æˆ to è¿™ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯ç§»åŠ¨æœºå™¨äººåˆ° to çš„ä½ç½® 85 else 86 ng ^= (1 \u003c\u003c (from + 4)), ng ^= (1 \u003c\u003c (to + 4)); // æŠŠ ng çš„ from å¯¹åº”çš„ bit ä½ç½® 0ï¼Œç„¶åæŠŠ to å¯¹åº”çš„ bit ä½ç½® 1ï¼Œä¹Ÿå°±æ˜¯æŠŠçŸ³å¤´ä» from ä½ç½®ç§»åŠ¨åˆ° to è¿™ä¸ªä½ç½® 87 if (VIS[ng]) 88 continue; // æ–°çš„çŠ¶æ€å·²ç»è®¿é—®è¿‡ 89 VIS[ng] = 1; // æ ‡è®°è®¿é—® 90 // è¿™é‡Œæ„å»ºçš„æ–° State çš„ newNode çš„ next å±æ€§æŒ‡å‘çš„æ˜¯ç§»åŠ¨å‰çš„ State çš„ path Node 91 q.push(State(ng, s.len + 1, newNode(s.path, from, to))); 92 } 93} 94 95// bfs 96void solve() { 97 // å®šä¹‰å¹¶åˆå§‹åŒ–åŸå§‹çš„çŠ¶æ€ 98 State s; 99 _for(i, 0, m) s.setRock(O[i]); 100 s.setP(S); 101 queue\u003cState\u003e q; 102 q.push(s); 103 VIS[s.g] = 1; // æ ‡è®°å½“å‰æœºå™¨äººå’ŒçŸ³å¤´çš„çŠ¶æ€å·²ç»è¢«è®¿é—®è¿‡ 104 // bfs ä¸€å±‚ä¸€å±‚åœ°éå† 105 while (!q.empty()) { 106 const State \u0026st = q.front(); 107 int rp = st.getP(); 108 if (rp == T) { // åˆ°è¾¾ç›®çš„åœ°ï¼Œå› ä¸ºæ˜¯ bfsï¼Œæ‰€ä»¥ä¸€æ—¦åˆ°è¾¾ç›®çš„åœ°ï¼Œä¹Ÿå°±è¡¨æ˜æ˜¯æœ€çŸ­è·¯å¾„ä¹‹ä¸€ï¼Œåé¢ä¸å¯èƒ½æœ‰ç§»åŠ¨æ­¥æ•°æ›´å°‘çš„ç»“æœï¼Œæœ€å¥½çš„æƒ…å†µä¹Ÿæ˜¯èŠ±è´¹å’Œå½“å‰ä¸€æ ·çš„æ­¥æ•° 109 cout \u003c\u003c st.len \u003c\u003c endl \u003c\u003c st.path; 110 return; 111 } 112 tryMove(st, rp, q); // å°è¯•ç§»åŠ¨æœºå™¨äºº 113 _for(i, 0, n) if (st[i]) tryMove(st, i, q); // å°è¯•ç§»åŠ¨çŸ³å¤´ 114 q.pop(); 115 } 116 cout \u003c\u003c \"-1\" \u003c\u003c endl; // æ— æ³•åˆ°è¾¾ç›®çš„åœ° 117} 118 119int main() { 120 // é‡å®šå‘æ ‡å‡†è¾“å…¥åˆ°æ–‡ä»¶ 121 string relativePathToCurrentCppFile = \"./data/UVa12569/input1.txt\"; 122 // relativePathToCurrentCppFile = \"./data/UVa12569/input2.txt\"; 123 // å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œç¼–è¯‘å‡ºæ¥çš„å¯æ‰§è¡Œæ–‡ä»¶çš„ 124 ifstream inputFile(\"./ch07\" + relativePathToCurrentCppFile.substr(1, relativePathToCurrentCppFile.size() - 1)); 125 if (!inputFile.is_open()) { 126 cerr \u003c\u003c \"Failed to open input data file.\" \u003c\u003c endl; 127 return 2; 128 } 129 streambuf *cinbuf = cin.rdbuf(); // save original buf 130 cin.rdbuf(inputFile.rdbuf()); 131 132 int K = readint(); // è¯»å– case çš„æ•°é‡ï¼Œä¸ºäº†å’Œ case å…³é”®å­—åŒºåˆ†ï¼Œä¸€èˆ¬ç”¨ Kase æˆ–è€… K æ¥è¡¨ç¤º case 133 for (int t = 1; t \u003c= K; t++) { 134 memset(VIS, 0, sizeof(VIS)); // åˆå§‹åŒ–ç½® 0 135 cin \u003e\u003e n \u003e\u003e m \u003e\u003e S \u003e\u003e T; // è¯»å…¥ n m S T 136 --S; // ç¨‹åºç”¨åˆ°çš„ç¼–å·è¦å‡ 1 137 --T; // åŒä¸Š 138 cout \u003c\u003c \"Case \" \u003c\u003c t \u003c\u003c \": \"; 139 _for(i, 0, m) O[i] = readint() - 1; // è¯»å…¥çŸ³å¤´çš„ç¼–å·ï¼Œç¼–å·æ˜¯ä»ç»™çš„æ•°æ®å‡ 1 è€Œå¾—æ¥ 140 _for(i, 0, n) G[i].clear(); // æ¸…é™¤ä¹‹å‰çš„æ•°æ® 141 142 // æ„å»ºé‚»æ¥çŸ©é˜µ 143 _for(i, 0, n - 1) { // è¯»å…¥ n - 1 æ¡è¾¹ 144 int u = readint() - 1, v = readint() - 1; // æ¯ä¸€ä¸ªé¡¶ç‚¹çš„ç¼–å·éƒ½è¦å‡ 1 145 G[u].push_back(v); 146 G[v].push_back(u); 147 } 148 149 solve(); 150 pool.dispose(); // é‡Šæ”¾å†…å­˜ 151 cout \u003c\u003c endl; 152 } 153 154 // æ¢å¤æ ‡å‡†è¾“å…¥ 155 cin.rdbuf(cinbuf); 156 return 0; 157} çº¯å‡€çš„ä»£ç  ç”±äºä¸Šé¢çš„ä»£ç æˆ‘ä¸ºäº†è‡ªå·±æµ‹è¯•æ–¹ä¾¿è¿›è¡Œæ ‡å‡†è¾“å…¥æµé‡å®šå‘çš„å¤„ç†ï¼Œæ˜¯ä¸èƒ½ç›´æ¥æäº¤çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘åœ¨ä¸‹é¢æä¾›ä¸€ä»½çº¯å‡€çš„å¯ä»¥ç”¨äºæäº¤éªŒè¯çš„ä»£ç ï¼Œè¿™é‡ŒåŒæ—¶å»é™¤äº†æ‰€æœ‰çš„æ³¨é‡Šï¼Œå› ä¸ºä¸­æ–‡å­—ç¬¦ä¼¼ä¹ä¸è¢«æ¥å—ï¼Œ\n1#include 2#include 3#include 4#include 5#include 6 7#define _for(i, a, b) for (int i = (a); i \u003c (b); ++i) 8 9using namespace std; 10 11int readint() { 12 int x; 13 cin \u003e\u003e x; 14 return x; 15} 16 17template \u003ctypename T\u003e struct MemPool { 18 vector\u003cT *\u003e buf; 19 T *createNew() { 20 buf.push_back(new T()); 21 return buf.back(); 22 } 23 24 void dispose() { 25 for (int i = 0; i \u003c buf.size(); i++) 26 delete buf[i]; 27 buf.clear(); 28 } 29}; 30 31const int MAXN = 16; 32 33struct Node { 34 int from, to; 35 Node *next; 36}; 37 38struct State { 39 Node *path; 40 int g; 41 int len; 42 State(int gi = 0, int li = 0, Node *pn = NULL) : g(gi), len(li), path(pn) {} 43 inline bool operator[](size_t i) const { return g \u0026 (1 \u003c\u003c (i + 4)); } 44 inline void setRock(size_t i, bool val = true) { 45 if (val) 46 g |= 1 \u003c\u003c (i + 4); 47 else 48 g \u0026= ~(1 \u003c\u003c (i + 4)); 49 } 50 51 inline int getP() const { return g \u0026 15; } 52 inline void setP(int p) { g = ((g \u003e\u003e 4) \u003c\u003c 4) | p; } 53}; 54 55vector\u003cint\u003e G[MAXN]; 56MemPool\u003cNode\u003e pool; 57 58int n, m, S, T, O[MAXN], VIS[1 \u003c\u003c 19]; 59Node *newNode(Node *next = NULL, int u = -1, int v = -1) { 60 Node *p = pool.createNew(); 61 p-\u003enext = next, p-\u003efrom = u, p-\u003eto = v; 62 return p; 63} 64 65ostream \u0026operator\u003c\u003c(ostream \u0026os, Node *p) { 66 if (p == NULL) 67 return os; 68 os \u003c\u003c p-\u003enext \u003c\u003c p-\u003efrom + 1 \u003c\u003c \" \" \u003c\u003c p-\u003eto + 1 \u003c\u003c endl; 69 return os; 70} 71 72void tryMove(const State \u0026s, int from, queue\u003cState\u003e \u0026q) { 73 int rp = s.getP(); 74 for (auto to : G[from]) { 75 if ((to == rp) || s[to]) 76 continue; 77 int ng = s.g; 78 if (from == rp) 79 ng = ((s.g \u003e\u003e 4) \u003c\u003c 4) | to; 80 else 81 ng ^= (1 \u003c\u003c (from + 4)), ng ^= (1 \u003c\u003c (to + 4)); 82 if (VIS[ng]) 83 continue; 84 VIS[ng] = 1; 85 86 q.push(State(ng, s.len + 1, newNode(s.path, from, to))); 87 } 88} 89 90void solve() { 91 92 State s; 93 _for(i, 0, m) s.setRock(O[i]); 94 s.setP(S); 95 queue\u003cState\u003e q; 96 q.push(s); 97 VIS[s.g] = 1; 98 99 while (!q.empty()) { 100 const State \u0026st = q.front(); 101 int rp = st.getP(); 102 if (rp == T) { 103 cout \u003c\u003c st.len \u003c\u003c endl \u003c\u003c st.path; 104 return; 105 } 106 tryMove(st, rp, q); 107 _for(i, 0, n) if (st[i]) tryMove(st, i, q); 108 q.pop(); 109 } 110 cout \u003c\u003c \"-1\" \u003c\u003c endl; 111} 112 113int main() { 114 int K = readint(); 115 for (int t = 1; t \u003c= K; t++) { 116 memset(VIS, 0, sizeof(VIS)); 117 cin \u003e\u003e n \u003e\u003e m \u003e\u003e S \u003e\u003e T; 118 --S; 119 --T; 120 cout \u003c\u003c \"Case \" \u003c\u003c t \u003c\u003c \": \"; 121 _for(i, 0, m) O[i] = readint() - 1; 122 _for(i, 0, n) G[i].clear(); 123 124 _for(i, 0, n - 1) { 125 int u = readint() - 1, v = readint() - 1; 126 G[u].push_back(v); 127 G[v].push_back(u); 128 } 129 130 solve(); 131 pool.dispose(); 132 cout \u003c\u003c endl; 133 } 134 135 return 0; 136} å½“ç„¶ï¼Œè¿™ä¸ªä»£ç ä¹Ÿæ˜¯å¯ä»¥åœ¨æˆ‘çš„ GitHub ä»“åº“ä¸­æ‰¾åˆ°çš„ã€‚\nå‚è€ƒ 1ã€ã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸ã€‹ç¬¬äºŒç‰ˆ\n2ã€https://github.com/sukhoeing/aoapc-bac2nd-keys\n",
  "wordCount" : "5144",
  "inLanguage": "zh",
  "image": "https://i.postimg.cc/7hwBy7VS/calcr.png","datePublished": "2024-08-21T23:56:38+08:00",
  "dateModified": "2024-08-21T23:56:38+08:00",
  "author":{
    "@type": "Person",
    "name": "Sonny Calcr"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/uva12569/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SonnyCalcr's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.png"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="SonnyCalcr&#39;s Blog (Alt + H)">SonnyCalcr&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="SonnyCalcr&#39;s Blog">
                    <span>é¦–é¡µ</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="æœç´¢">
                    <span>æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      UVa12569
    </h1>
    <div class="post-meta"><span title='2024-08-21 23:56:38 +0800 CST'>2024-08-21</span>&nbsp;Â·&nbsp;11 åˆ†é’Ÿ&nbsp;Â·&nbsp;Sonny Calcr

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%89%8d%e8%a8%80" aria-label="å‰è¨€">å‰è¨€</a></li>
                <li>
                    <a href="#part1" aria-label="Part1">Part1</a></li>
                <li>
                    <a href="#part2" aria-label="Part2">Part2</a></li>
                <li>
                    <a href="#part3" aria-label="Part3">Part3</a></li>
                <li>
                    <a href="#part4" aria-label="Part4">Part4</a></li>
                <li>
                    <a href="#part5" aria-label="Part5">Part5</a></li>
                <li>
                    <a href="#%e5%ae%8c%e6%95%b4%e7%9a%84%e4%bb%a3%e7%a0%81%e5%92%8c%e6%b3%a8%e9%87%8a" aria-label="å®Œæ•´çš„ä»£ç å’Œæ³¨é‡Š">å®Œæ•´çš„ä»£ç å’Œæ³¨é‡Š</a></li>
                <li>
                    <a href="#%e7%ba%af%e5%87%80%e7%9a%84%e4%bb%a3%e7%a0%81" aria-label="çº¯å‡€çš„ä»£ç ">çº¯å‡€çš„ä»£ç </a></li>
                <li>
                    <a href="#%e5%8f%82%e8%80%83" aria-label="å‚è€ƒ">å‚è€ƒ</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="å‰è¨€">å‰è¨€<a hidden class="anchor" aria-hidden="true" href="#å‰è¨€">#</a></h2>
<p>é¦–å…ˆï¼Œå»ºè®®å¤§å®¶è¯»ä¸€ä¸‹åŸé¢˜ç›®ï¼Œé¢˜ç›®çš„å†…å®¹è¿™é‡Œå°±ä¸æ”¾äº†ï¼Œå¤§å®¶å¯ä»¥åˆ°è¿™ä¸ªåœ°å€å»ä¸‹è½½: <a href="https://vjudge.net/problem/UVA-12569">https://vjudge.net/problem/UVA-12569</a>ï¼Œæœ‰äº›äººå¯èƒ½è¯´è‹±æ–‡ä¸å¤ªå¥½ï¼Œé‚£ä¹ˆï¼Œä¹Ÿæ²¡å…³ç³»ï¼Œé™¤äº†æŸ¥å­—å…¸ï¼Œç°åœ¨è¿˜å¯ä»¥ä½¿ç”¨è¿™ä¸ªç¿»è¯‘æ’ä»¶ï¼šæ²‰æµ¸å¼ç¿»è¯‘ï¼Œæ€»ä¹‹ï¼Œç°åœ¨è‹±è¯­è¯­è¨€å±‚é¢çš„é—®é¢˜æ˜¯ä¸ä¼šæœ‰é—®é¢˜çš„ã€‚</p>
<p>ä¸ºä»€ä¹ˆæˆ‘å»ºè®®å¤§å®¶è¯»åŸé¢˜ç›®å‘¢ï¼Ÿè™½ç„¶æˆ‘ä»¬å¤§å®¶æ¥è§¦åˆ°è¿™ä¸ªé¢˜ç›®å¯èƒ½éƒ½æ˜¯é€šè¿‡åˆ˜æ±ä½³çš„è¿™æœ¬ã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸ã€‹æ‰é€‰æ‹©å»çœ‹çš„ï¼Œä½†æ˜¯ï¼Œä¹¦ä¸­ç»™å‡ºçš„æè¿°éƒ½æ˜¯å¾ˆç•¥çš„ï¼Œç®€å•è®²ä¸€ç‚¹ï¼Œé¢˜ç›®å¾ˆé‡è¦çš„è¾“å…¥å’Œè¾“å‡ºæ ·ä¾‹æ•°æ®ï¼Œä¹¦ä¸Šä¸€èˆ¬éƒ½æ˜¯æ²¡æœ‰çš„ï¼Œå…¶ä»–çš„ç»†èŠ‚æ›´ä¸å¿…è¯´ã€‚å¤§æ¦‚å°±è¿™æ ·ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬æ¥è¯¦ç»†ç ”ç©¶ä¸€ä¸‹ UVa12569 è¿™é“é¢˜çš„æ€è·¯å’Œè§£æã€‚</p>
<p>è¿™é“é¢˜æ•´ä½“çš„æ€è·¯æ˜¯ BFSã€‚ç„¶åä»£ç å‚è€ƒ(å¯èƒ½æœ‰æˆ‘çš„å¾®å°è°ƒæ•´)çš„æ˜¯ã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸-ä¹ é¢˜ä¸è§£ç­”ã€‹çš„é…å¥—ä»£ç ï¼ŒGitHub åœ°å€ä¸ºï¼š<a href="https://github.com/sukhoeing/aoapc-bac2nd-keys">https://github.com/sukhoeing/aoapc-bac2nd-keys</a>ã€‚</p>
<p>æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´å¤šçš„æµ‹è¯•æ•°æ®ï¼Œè¿™ä¸ª udebug çš„ç½‘ç«™ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ï¼š<a href="https://www.udebug.com">https://www.udebug.com</a>ã€‚æœ¬é¢˜çš„æµ‹è¯•æ•°æ®åœ°å€ä¸ºï¼š<a href="https://www.udebug.com/UVa/12569">https://www.udebug.com/UVa/12569</a>ã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘çš„ä»£ç æ‰˜ç®¡åœ¨äº†è¿™ä¸ªåœ°å€ï¼š<a href="https://github.com/sonnycalcr/aoapc-homework">https://github.com/sonnycalcr/aoapc-homework</a>ã€‚</p>
<p>é¦–å…ˆï¼Œè¿™é“é¢˜å¾ˆå¤šäººå¯èƒ½è§‰å¾—ç®€å•ï¼Œæˆ‘è¯´ä¸€ä¸‹æˆ‘çš„è§‚ç‚¹ï¼šå¯¹äºåˆå­¦è€…æˆ–è€…ç®—æ³•åˆé˜¶çš„åŒå­¦æ¥è®²ï¼Œè¿™é“é¢˜è¿˜æ˜¯æœ‰å¾ˆå¤šå€¼å¾—å­¦ä¹ çš„éƒ¨åˆ†çš„ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘æŒ‘ä¸€äº›å…³é”®çš„ä»£ç è®²ä¸€ä¸‹ï¼Œæ›´è¯¦ç»†çš„è§£é‡Šåœ¨ä»£ç çš„æ³¨é‡Šé‡Œé¢ã€‚</p>
<p>æ³¨æ„ï¼Œåœ¨å…·ä½“çœ‹/å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªç‚¹ï¼Œé¢˜ç›®ä¸­çš„ç¼–å·æ˜¯ä» 1 å¼€å§‹é€’å¢çš„ï¼Œè€Œä¸‹é¢æˆ‘ä»¬çš„ç¨‹åºéƒ½æ˜¯ä» 0 å¼€å§‹é€’å¢çš„ã€‚</p>
<h2 id="part1">Part1<a hidden class="anchor" aria-hidden="true" href="#part1">#</a></h2>
<p>å…ˆçœ‹æ•°æ®ç»“æ„ï¼Œä¸€ä¸ªæ˜¯ <code>Node</code>ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">struct</span> <span class="nc">Node</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="kt">int</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="n">Node</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>Node æ˜¯è¡¨ç¤ºè·¯å¾„çš„é“¾è¡¨èŠ‚ç‚¹ï¼Œto è¡¨ç¤ºçš„æ˜¯å½“å‰çš„èŠ‚ç‚¹ï¼Œfrom æ˜¯ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸»è¦æ˜¯ç”¨æ¥åœ¨ <code>State</code> ç±»å‹ä¸­è¡¨ç¤º <code>path</code>ï¼Œä¹Ÿå°±æ˜¯å½“å‰çš„çŠ¶æ€æ˜¯ç”±ä¸Šä¸€ä¸ªçŠ¶æ€ä» from ç§»åŠ¨äº†æœºå™¨äºº/çŸ³å¤´åˆ° to è€Œè½¬åŒ–è¿‡æ¥çš„ã€‚</p>
<h2 id="part2">Part2<a hidden class="anchor" aria-hidden="true" href="#part2">#</a></h2>
<p>å†çœ‹ <code>State</code>ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">struct</span> <span class="nc">State</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="n">Node</span> <span class="o">*</span><span class="n">path</span><span class="p">;</span> <span class="c1">// è·¯å¾„
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">g</span><span class="p">;</span>      <span class="c1">// çŠ¶æ€å‹ç¼©ï¼Œå‰ 4 ä½(å½“ç„¶æ˜¯ä»å³å¾€å·¦)è¡¨ç¤ºæœºå™¨äººğŸ¤–ä½ç½®çš„ç¼–å·ï¼Œå› ä¸ºèŠ‚ç‚¹æ•° n çš„èŒƒå›´æ˜¯ï¼š4 &lt;= n &lt;= 15ï¼Œåé¢ 16 ä½çš„æ¯ä¸€ä½ç”¨æ¥è¡¨ç¤ºä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ï¼Œæ¯”å¦‚ï¼Œ(2 + 4) è¿™ä¸ª bit ä½ä¸º 1ï¼Œå°±è¡¨ç¤ºç¼–å·ä¸º 2 çš„ä½ç½®ä¸Šæœ‰çŸ³å¤´
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">len</span><span class="p">;</span>    <span class="c1">// è·¯å¾„é•¿åº¦ï¼Œåˆ°äº†å½“å‰çŠ¶æ€å·²ç»ç»å†çš„é•¿åº¦
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1"></span>    <span class="n">State</span><span class="p">(</span><span class="kt">int</span> <span class="n">gi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">li</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Node</span> <span class="o">*</span><span class="n">pn</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">:</span> <span class="n">g</span><span class="p">(</span><span class="n">gi</span><span class="p">),</span> <span class="n">len</span><span class="p">(</span><span class="n">li</span><span class="p">),</span> <span class="n">path</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="kr">inline</span> <span class="kt">bool</span> <span class="k">operator</span><span class="p">[](</span><span class="n">size_t</span> <span class="n">i</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">g</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span> <span class="p">}</span> <span class="c1">// ä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ï¼Œå‰ 4 ä½è¢«æœºå™¨äººå æ®äº†ï¼Œå¾€åçš„ä½æ‰èƒ½ç”¨æ¥è¡¨ç¤ºçŸ³å¤´
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1"></span>    <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">setRock</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">val</span> <span class="o">=</span> <span class="nb">true</span><span class="p">)</span> <span class="p">{</span>                      <span class="c1">// è®¾ç½®ä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="n">g</span> <span class="o">|=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">// ä½æˆ–æ“ä½œæ¥æŠŠç¬¬(i + 4)ä½æ¥ç½® 1
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"></span>        <span class="k">else</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">            <span class="n">g</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span> <span class="c1">// å…ˆå–åï¼Œå†ç”¨ä¸æ“ä½œæ¥æŠŠç¬¬(i + 4)ä½æ¥ç½® 0
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">    <span class="c1">// æœºå™¨äººçš„ä½ç½®æ“ä½œ
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span>    <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">getP</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">g</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">;</span> <span class="p">}</span>           <span class="c1">// ä¸ 1111(äºŒè¿›åˆ¶) è¿›è¡Œä¸æ“ä½œï¼Œå–å‡ºå‰ 4 ä½çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æœºå™¨äººçš„ä½ç½®
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span>    <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">setP</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span> <span class="n">g</span> <span class="o">=</span> <span class="p">((</span><span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">p</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// è®¾ç½®æœºå™¨äººçš„ä½ç½®ï¼Œè¿™é‡Œå…ˆå³ç§»å†å·¦ç§» 4 ä½æ¸…é™¤åŸæœ‰çš„æ•°æ®
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span></code></pre></div><p>æ‰€è°“çš„ Stateï¼Œå°±æ˜¯å½“å‰çš„å±€é¢ï¼Œç”±ä»¥ä¸‹å‡ ä¸ªç»´åº¦çš„æ•°æ®æ„æˆï¼Œ</p>
<ul>
<li><code>path</code> æ˜¯è·¯å¾„ï¼Œä¸Šé¢è®²è¿‡äº†ï¼Œå…¶ä¸­ä¿å­˜äº†ä¸Šä¸€ä¸ªçŠ¶æ€è½¬å˜åˆ°å½“å‰çŠ¶æ€æ˜¯ç§»åŠ¨äº†å“ªä¸€ä¸ªç¼–å·ï¼Œç„¶ååˆæ˜¯ç§»åŠ¨åˆ°äº†å“ªä¸€ä¸ªç¼–å·ï¼ŒåŒæ—¶ <code>next</code> æŒ‡å‘äº†ä¸Šä¸€æ¬¡çŠ¶æ€çš„ <code>path</code>ã€‚</li>
<li><code>g</code> ä»£è¡¨äº†æ•´ä½“çš„çŠ¶æ€ï¼Œå…¶ä¸­ï¼Œå‰ 4 ä½(åˆ†åˆ«æ˜¯ï¼š0, 1, 2, 3)äºŒè¿›åˆ¶å€¼ä½œä¸ºä¸€ä¸ªæ•´ä½“å¯ä»¥è½¬åŒ–æˆåè¿›åˆ¶ï¼Œè¡¨ç¤ºäº†å½“å‰æœºå™¨äººåœ¨å“ªä¸ªç¼–å·çš„ä½ç½®ï¼›ç„¶åå†å¾€å·¦å– 16 ä½äºŒè¿›åˆ¶ bit ä½ï¼Œå…¶ä¸­æ¯ä¸€ä½éƒ½ä»£è¡¨äº†ä¸€ä¸ªç¼–å·ï¼Œæ¯”å¦‚ï¼Œ0 å·ä½ç½®çš„ bit ä½æ˜¯ (0 + 4)ï¼Œä¹Ÿå°±æ˜¯ç¬¬ 4 ä½ï¼Œå¦‚æœè¿™ä¸€ä½ä¸º 1ï¼Œåˆ™è¡¨ç¤ºæ ‘ä¸­ç¼–å·ä¸º 0 çš„ä½ç½®ä¸Šæœ‰çŸ³å¤´ï¼Œåä¹‹åˆ™æ²¡æœ‰ï¼Œå…¶å®ƒçš„ç¼–å·ä¾æ­¤ç±»æ¨ã€‚</li>
<li><code>len</code> è¡¨ç¤ºä»æœ€åŸå§‹çš„çŠ¶æ€æ¥åˆ°äº†å½“å‰çš„çŠ¶æ€ï¼Œä¸€å…±èµ°äº†å¤šå°‘æ­¥ã€‚</li>
</ul>
<p>ç†è§£äº†ä¸Šé¢çš„å‡ ä¸ªæˆå‘˜å˜é‡ï¼Œå°±ä¸éš¾ç†è§£ä¹‹åçš„å‡ ä¸ªæˆå‘˜å‡½æ•°äº†ã€‚</p>
<h2 id="part3">Part3<a hidden class="anchor" aria-hidden="true" href="#part3">#</a></h2>
<p>æˆ‘ä»¬å†çœ‹è¾“å‡ºè¿ç®—ç¬¦çš„é‡è½½ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">// ä¸€ä¸ªé€’å½’çš„è¾“å‡ºï¼Œå› ä¸º tryMove ä¿è¯äº†æœ€ç»ˆåˆ°è¾¾ç»ˆç‚¹æ—¶çš„çŠ¶æ€ä¸­çš„ path æ˜¯é€’å½’åœ°å¾€å‰æŒ‡çš„
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"></span><span class="n">ostream</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">os</span><span class="p">,</span> <span class="n">Node</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="k">return</span> <span class="n">os</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">from</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">to</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="c1">// è¿™é‡Œè¦æŠŠ from å’Œ to åˆ†åˆ«åŠ  1 æ¥æ˜ å°„æˆé¢˜ç›®ä¸­çš„ä» 1 å¼€å§‹çš„åºå·
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">os</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„ï¼Œå› ä¸º <code>Node</code> å®é™…ä¸Šæ˜¯ç”¨æ¥è¡¨ç¤º <code>State</code> ä¸­çš„ <code>path</code> çš„ï¼Œæ‰€ä»¥ï¼Œå¹¶ä¸”ï¼Œæˆ‘ä»¬æ˜¯åˆ°äº†æœ€åæˆåŠŸåˆ°è¾¾ç»ˆç‚¹æ—¶(çœ‹ä»£ç  109 è¡Œ)ç›´æ¥æ‰“å°æœ€ç»ˆçš„é‚£ä¸ª <code>State</code> çš„ <code>path</code> çš„ï¼Œè€Œæ¯ä¸€ä¸ª <code>path</code> æŒ‡å‘çš„åˆæ˜¯ä¸Šä¸€ä¸ª <code>State</code> çš„ <code>path</code>ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªè¾“å‡ºé‡è½½å°±è¾¾åˆ°äº†è¾“å‡ºä»åˆå§‹çš„çŠ¶æ€ç§»åŠ¨åˆ°æœ€ç»ˆç›®æ ‡çš„å…¨éƒ¨è·¯å¾„çš„ç›®çš„ã€‚</p>
<h2 id="part4">Part4<a hidden class="anchor" aria-hidden="true" href="#part4">#</a></h2>
<p>ç„¶åï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å°è¯•ç§»åŠ¨æœºå™¨äººæˆ–è€…çŸ³å¤´çš„æ€è·¯ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå†æ¥çœ‹ä¸€ä¸‹å…¨å±€å˜é‡ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="c1">// èŠ‚ç‚¹çš„æœ€å¤§æ•°é‡æ˜¯ 16ï¼Œæ ¹æ®é¢˜ç›®ä¸­çš„æ¡ä»¶å¾—æ¥
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">G</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span> <span class="c1">// å›¾çš„é‚»æ¥çŸ©é˜µè¡¨ç¤ºï¼Œé¢˜ç›®ä¸­ç®€åŒ–æˆäº†æ ‘(æ— ç¯å›¾)
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"></span><span class="n">MemPool</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">pool</span><span class="p">;</span>  <span class="c1">// é“¾è¡¨èŠ‚ç‚¹åˆ†é…ï¼Œç”¨ MemPool æ¯”è¾ƒå¥½ç®¡ç†å†…å­˜
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">// n: é¡¶ç‚¹æ•°ï¼›m: éšœç¢ç‰©(çŸ³å¤´)æ•°é‡ï¼›S: æºï¼Œå³æœºå™¨äººçš„èµ·ç‚¹ä½ç½®ï¼›T: ç›®æ ‡ä½ç½®
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1">// O: æ¯ä¸€ä¸ªçŸ³å¤´çš„ä½ç½®ç¼–å·
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="c1">// VIS: è¡¨ç¤ºæŸä¸ªä½ç½®æ˜¯å¦å·²ç» visited è¿‡äº†
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">O</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">VIS</span><span class="p">[</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">19</span><span class="p">];</span>
</span></span></code></pre></div><p>è¿™ä¸ªæ³¨é‡Šæ¯”è¾ƒæ¸…æ™°äº†ï¼Œå°±ä¸å¤šè®²äº†ã€‚ç„¶åï¼Œè®©æˆ‘ä»¬è¿›å…¥æ­£é¢˜ï¼Œæ¥çœ‹ <code>tryMove</code> è¿™ä¸ªå‡½æ•°ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// å°è¯•ç§»åŠ¨åœ¨ç‚¹ from ä¸Šçš„ç‰©ä½“(æœºå™¨äººæˆ–è€…çŸ³å¤´)
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">tryMove</span><span class="p">(</span><span class="k">const</span> <span class="n">State</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">from</span><span class="p">,</span> <span class="n">queue</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">q</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="kt">int</span> <span class="n">rp</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">getP</span><span class="p">();</span> <span class="c1">// è·å–å½“å‰çŠ¶æ€ä¸‹æœºå™¨äººçš„ä½ç½®ç¼–å·
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">to</span> <span class="p">:</span> <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="n">to</span> <span class="o">==</span> <span class="n">rp</span><span class="p">)</span> <span class="o">||</span> <span class="n">s</span><span class="p">[</span><span class="n">to</span><span class="p">])</span> <span class="c1">// to å’Œå½“å‰çŠ¶æ€çš„æœºå™¨äººä½ç½®é‡åˆæˆ–è€… to çš„ä½ç½®ä¸Šæœ‰æœºå™¨äºº
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="c1"></span>            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="kt">int</span> <span class="n">ng</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">g</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="o">==</span> <span class="n">rp</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            <span class="n">ng</span> <span class="o">=</span> <span class="p">((</span><span class="n">s</span><span class="p">.</span><span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">to</span><span class="p">;</span> <span class="c1">// æŠŠ s.g çš„å‰ 4 ä½ç½®æˆ to è¿™ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯ç§»åŠ¨æœºå™¨äººåˆ° to çš„ä½ç½®
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"></span>        <span class="k">else</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">            <span class="n">ng</span> <span class="o">^=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">from</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)),</span> <span class="n">ng</span> <span class="o">^=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">to</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span> <span class="c1">// æŠŠ ng çš„ from å¯¹åº”çš„ bit ä½ç½® 0ï¼Œç„¶åæŠŠ to å¯¹åº”çš„ bit ä½ç½® 1ï¼Œä¹Ÿå°±æ˜¯æŠŠçŸ³å¤´ä» from ä½ç½®ç§»åŠ¨åˆ° to è¿™ä¸ªä½ç½®
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">VIS</span><span class="p">[</span><span class="n">ng</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="k">continue</span><span class="p">;</span> <span class="c1">// æ–°çš„çŠ¶æ€å·²ç»è®¿é—®è¿‡
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"></span>        <span class="n">VIS</span><span class="p">[</span><span class="n">ng</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">// æ ‡è®°è®¿é—®
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span>        <span class="c1">// è¿™é‡Œæ„å»ºçš„æ–° State çš„ newNode çš„ next å±æ€§æŒ‡å‘çš„æ˜¯ç§»åŠ¨å‰çš„ State çš„ path Node
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1"></span>        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">State</span><span class="p">(</span><span class="n">ng</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">newNode</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">path</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">)));</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å› ä¸º <code>G</code> æ˜¯é‚»æ¥çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹æ¥è¿›è¡Œ <code>for</code> å¾ªç¯ï¼Œéå†ä¸ <code>from</code> é¡¶ç‚¹æ‰€é‚»æ¥çš„å‡ ä¸ªé¡¶ç‚¹ï¼Œå°è¯•å»ç§»åŠ¨åˆ°è¿™äº›ä½ç½®ï¼Œç„¶åå°±æ˜¯ä¸€ç³»åˆ—çš„ç»†èŠ‚å¤„ç†ï¼Œçœ‹æ³¨é‡Šæ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚</p>
<h2 id="part5">Part5<a hidden class="anchor" aria-hidden="true" href="#part5">#</a></h2>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹æœ€ç»ˆçš„æ ¸å¿ƒçš„ä»£ç ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// bfs
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="c1">// å®šä¹‰å¹¶åˆå§‹åŒ–åŸå§‹çš„çŠ¶æ€
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"></span>    <span class="n">State</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="n">s</span><span class="p">.</span><span class="n">setRock</span><span class="p">(</span><span class="n">O</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="n">s</span><span class="p">.</span><span class="n">setP</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="n">queue</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">VIS</span><span class="p">[</span><span class="n">s</span><span class="p">.</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// æ ‡è®°å½“å‰æœºå™¨äººå’ŒçŸ³å¤´çš„çŠ¶æ€å·²ç»è¢«è®¿é—®è¿‡
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"></span>    <span class="c1">// bfs ä¸€å±‚ä¸€å±‚åœ°éå†
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">const</span> <span class="n">State</span> <span class="o">&amp;</span><span class="n">st</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="kt">int</span> <span class="n">rp</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">getP</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">rp</span> <span class="o">==</span> <span class="n">T</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// åˆ°è¾¾ç›®çš„åœ°ï¼Œå› ä¸ºæ˜¯ bfsï¼Œæ‰€ä»¥ä¸€æ—¦åˆ°è¾¾ç›®çš„åœ°ï¼Œä¹Ÿå°±è¡¨æ˜æ˜¯æœ€çŸ­è·¯å¾„ä¹‹ä¸€ï¼Œåé¢ä¸å¯èƒ½æœ‰ç§»åŠ¨æ­¥æ•°æ›´å°‘çš„ç»“æœï¼Œæœ€å¥½çš„æƒ…å†µä¹Ÿæ˜¯èŠ±è´¹å’Œå½“å‰ä¸€æ ·çš„æ­¥æ•°
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"></span>            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">st</span><span class="p">.</span><span class="n">len</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">st</span><span class="p">.</span><span class="n">path</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">            <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="n">tryMove</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">rp</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>                         <span class="c1">// å°è¯•ç§»åŠ¨æœºå™¨äºº
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="c1"></span>        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">tryMove</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="c1">// å°è¯•ç§»åŠ¨çŸ³å¤´
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="c1"></span>        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;-1&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="c1">// æ— æ³•åˆ°è¾¾ç›®çš„åœ°
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>è¿™é‡Œå°±æ˜¯ä¸€ä¸ªçº¯ç²¹çš„ bfsï¼Œæˆ‘ä»¬å®šä¹‰å¥½äº†åŸå§‹çš„çŠ¶æ€ä¹‹åï¼Œç„¶ååˆ©ç”¨é˜Ÿåˆ—è¿™ä¸ªæ•°æ®ç»“æ„ä¸€åœˆä¸€åœˆåœ°å¾€å¤–è¿›è¡Œæ³¢çº¹æ‰©æ•£æ€§åœ°éå†ï¼Œé˜Ÿåˆ—ä¸­ä»å‰å¾€åå­˜æ”¾çš„åˆ†åˆ«æ˜¯ç¬¬ 1 åœˆã€ç¬¬ 2 åœˆ&hellip;çš„æ•°æ®ï¼Œè€Œä¸”é˜Ÿåˆ—æ˜¯å…ˆè¿›å…ˆå‡º(FIFO, First In First Out)ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æš´åŠ›åœ°éå†æ‰€æœ‰çš„æƒ…å†µï¼Œå¹¶ä¸”ï¼Œå¯ä»¥ä¿è¯ï¼Œä¸€æ—¦ç¬¬ä¸€æ¬¡å¾—åˆ°äº†æƒ³è¦çš„ç»“æœï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªç»“æœå°±æ˜¯æˆ‘ä»¬æœ€ç»ˆæƒ³è¦çš„ç»“æœã€‚</p>
<h2 id="å®Œæ•´çš„ä»£ç å’Œæ³¨é‡Š">å®Œæ•´çš„ä»£ç å’Œæ³¨é‡Š<a hidden class="anchor" aria-hidden="true" href="#å®Œæ•´çš„ä»£ç å’Œæ³¨é‡Š">#</a></h2>
<p>ä»¥ä¸Šå°±æ˜¯å…³é”®çš„ä»£ç å’Œè§£é‡Šäº†ã€‚å…¶ä»–çš„ä¸œè¥¿æ²¡ä»€ä¹ˆå¥½è®²çš„ã€‚å…³äºæ•°æ®çš„è¾“å…¥å’Œå¤„ç†ï¼Œä¸Šé¢ä¹Ÿæ²¡æœ‰ç»†è®²ï¼Œç›´æ¥çœ‹æ³¨é‡Šå³å¯ã€‚</p>
<p>ä¸‹é¢å°±æ˜¯å®Œæ•´çš„ä»£ç å’Œè¯¦ç»†çš„æ³¨é‡Šï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln">  1</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;fstream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="cp">#define _for(i, a, b) for (int i = (a); i &lt; (b); ++i)
</span></span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 11</span><span class="cl">
</span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="kt">int</span> <span class="nf">readint</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 13</span><span class="cl">    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 14</span><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 15</span><span class="cl">    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 16</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 17</span><span class="cl">
</span></span><span class="line"><span class="ln"> 18</span><span class="cl"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="k">struct</span> <span class="nc">MemPool</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 19</span><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span> <span class="o">*&gt;</span> <span class="n">buf</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">    <span class="n">T</span> <span class="o">*</span><span class="nf">createNew</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">        <span class="n">buf</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span> <span class="n">T</span><span class="p">());</span>
</span></span><span class="line"><span class="ln"> 22</span><span class="cl">        <span class="k">return</span> <span class="n">buf</span><span class="p">.</span><span class="n">back</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 23</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 24</span><span class="cl">
</span></span><span class="line"><span class="ln"> 25</span><span class="cl">    <span class="kt">void</span> <span class="nf">dispose</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">buf</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">            <span class="k">delete</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">        <span class="n">buf</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">
</span></span><span class="line"><span class="ln"> 32</span><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="c1">// èŠ‚ç‚¹çš„æœ€å¤§æ•°é‡æ˜¯ 16
</span></span></span><span class="line"><span class="ln"> 33</span><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="ln"> 34</span><span class="cl"><span class="k">struct</span> <span class="nc">Node</span> <span class="p">{</span> <span class="c1">// è¡¨ç¤ºè·¯å¾„çš„é“¾è¡¨èŠ‚ç‚¹ï¼Œto è¡¨ç¤ºçš„æ˜¯å½“å‰çš„èŠ‚ç‚¹ï¼Œfrom æ˜¯ä¸Šä¸€ä¸ªèŠ‚ç‚¹
</span></span></span><span class="line"><span class="ln"> 35</span><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">    <span class="n">Node</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">
</span></span><span class="line"><span class="ln"> 39</span><span class="cl"><span class="k">struct</span> <span class="nc">State</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">    <span class="n">Node</span> <span class="o">*</span><span class="n">path</span><span class="p">;</span> <span class="c1">// è·¯å¾„
</span></span></span><span class="line"><span class="ln"> 41</span><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">g</span><span class="p">;</span>      <span class="c1">// çŠ¶æ€å‹ç¼©ï¼Œå‰ 4 ä½(å½“ç„¶æ˜¯ä»å³å¾€å·¦)è¡¨ç¤ºæœºå™¨äººğŸ¤–ä½ç½®çš„ç¼–å·ï¼Œå› ä¸ºèŠ‚ç‚¹æ•° n çš„èŒƒå›´æ˜¯ï¼š4 &lt;= n &lt;= 15ï¼Œåé¢ 16 ä½çš„æ¯ä¸€ä½ç”¨æ¥è¡¨ç¤ºä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ï¼Œæ¯”å¦‚ï¼Œ(2 + 4) è¿™ä¸ª bit ä½ä¸º 1ï¼Œå°±è¡¨ç¤ºç¼–å·ä¸º 2 çš„ä½ç½®ä¸Šæœ‰çŸ³å¤´
</span></span></span><span class="line"><span class="ln"> 42</span><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">len</span><span class="p">;</span>    <span class="c1">// è·¯å¾„é•¿åº¦ï¼Œåˆ°äº†å½“å‰çŠ¶æ€å·²ç»ç»å†çš„é•¿åº¦
</span></span></span><span class="line"><span class="ln"> 43</span><span class="cl"><span class="c1"></span>    <span class="n">State</span><span class="p">(</span><span class="kt">int</span> <span class="n">gi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">li</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Node</span> <span class="o">*</span><span class="n">pn</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">:</span> <span class="n">g</span><span class="p">(</span><span class="n">gi</span><span class="p">),</span> <span class="n">len</span><span class="p">(</span><span class="n">li</span><span class="p">),</span> <span class="n">path</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">    <span class="kr">inline</span> <span class="kt">bool</span> <span class="k">operator</span><span class="p">[](</span><span class="n">size_t</span> <span class="n">i</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">g</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span> <span class="p">}</span> <span class="c1">// ä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´ï¼Œå‰ 4 ä½è¢«æœºå™¨äººå æ®äº†ï¼Œå¾€åçš„ä½æ‰èƒ½ç”¨æ¥è¡¨ç¤ºçŸ³å¤´
</span></span></span><span class="line"><span class="ln"> 45</span><span class="cl"><span class="c1"></span>    <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">setRock</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">val</span> <span class="o">=</span> <span class="nb">true</span><span class="p">)</span> <span class="p">{</span>                      <span class="c1">// è®¾ç½®ä½ç½® i ä¸Šæ˜¯å¦æœ‰çŸ³å¤´
</span></span></span><span class="line"><span class="ln"> 46</span><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">            <span class="n">g</span> <span class="o">|=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">// ä½æˆ–æ“ä½œæ¥æŠŠç¬¬(i + 4)ä½æ¥ç½® 1
</span></span></span><span class="line"><span class="ln"> 48</span><span class="cl"><span class="c1"></span>        <span class="k">else</span>
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">            <span class="n">g</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span> <span class="c1">// å…ˆå–åï¼Œå†ç”¨ä¸æ“ä½œæ¥æŠŠç¬¬(i + 4)ä½æ¥ç½® 0
</span></span></span><span class="line"><span class="ln"> 50</span><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">    <span class="c1">// æœºå™¨äººçš„ä½ç½®æ“ä½œ
</span></span></span><span class="line"><span class="ln"> 52</span><span class="cl"><span class="c1"></span>    <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">getP</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">g</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">;</span> <span class="p">}</span>           <span class="c1">// ä¸ 1111(äºŒè¿›åˆ¶) è¿›è¡Œä¸æ“ä½œï¼Œå–å‡ºå‰ 4 ä½çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æœºå™¨äººçš„ä½ç½®
</span></span></span><span class="line"><span class="ln"> 53</span><span class="cl"><span class="c1"></span>    <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">setP</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span> <span class="n">g</span> <span class="o">=</span> <span class="p">((</span><span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">p</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// è®¾ç½®æœºå™¨äººçš„ä½ç½®ï¼Œè¿™é‡Œå…ˆå³ç§»å†å·¦ç§» 4 ä½æ¸…é™¤åŸæœ‰çš„æ•°æ®
</span></span></span><span class="line"><span class="ln"> 54</span><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">
</span></span><span class="line"><span class="ln"> 56</span><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">G</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span> <span class="c1">// å›¾çš„é‚»æ¥çŸ©é˜µè¡¨ç¤ºï¼Œé¢˜ç›®ä¸­ç®€åŒ–æˆäº†æ ‘(æ— ç¯å›¾)
</span></span></span><span class="line"><span class="ln"> 57</span><span class="cl"><span class="c1"></span><span class="n">MemPool</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">pool</span><span class="p">;</span>  <span class="c1">// é“¾è¡¨èŠ‚ç‚¹åˆ†é…ï¼Œç”¨ MemPool æ¯”è¾ƒå¥½ç®¡ç†å†…å­˜
</span></span></span><span class="line"><span class="ln"> 58</span><span class="cl"><span class="c1">// n: é¡¶ç‚¹æ•°ï¼›m: éšœç¢ç‰©(çŸ³å¤´)æ•°é‡ï¼›S: æºï¼Œå³æœºå™¨äººçš„èµ·ç‚¹ä½ç½®ï¼›T: ç›®æ ‡ä½ç½®
</span></span></span><span class="line"><span class="ln"> 59</span><span class="cl"><span class="c1">// O: æ¯ä¸€ä¸ªçŸ³å¤´çš„ä½ç½®ç¼–å·
</span></span></span><span class="line"><span class="ln"> 60</span><span class="cl"><span class="c1">// VIS: è¡¨ç¤ºæŸä¸ªä½ç½®æ˜¯å¦å·²ç» visited è¿‡äº†
</span></span></span><span class="line"><span class="ln"> 61</span><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">O</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">VIS</span><span class="p">[</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">19</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl"><span class="n">Node</span> <span class="o">*</span><span class="nf">newNode</span><span class="p">(</span><span class="n">Node</span> <span class="o">*</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span> <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 63</span><span class="cl">    <span class="n">Node</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">pool</span><span class="p">.</span><span class="n">createNew</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">    <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">next</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">from</span> <span class="o">=</span> <span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">to</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">    <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">
</span></span><span class="line"><span class="ln"> 68</span><span class="cl"><span class="c1">// ä¸€ä¸ªé€’å½’çš„è¾“å‡ºï¼Œå› ä¸º tryMove ä¿è¯äº†æœ€ç»ˆåˆ°è¾¾ç»ˆç‚¹æ—¶çš„çŠ¶æ€ä¸­çš„ path æ˜¯é€’å½’åœ°å¾€å‰æŒ‡çš„
</span></span></span><span class="line"><span class="ln"> 69</span><span class="cl"><span class="c1"></span><span class="n">ostream</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">os</span><span class="p">,</span> <span class="n">Node</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">        <span class="k">return</span> <span class="n">os</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">    <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">from</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">to</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="c1">// è¿™é‡Œè¦æŠŠ from å’Œ to åˆ†åˆ«åŠ  1 æ¥æ˜ å°„æˆé¢˜ç›®ä¸­çš„ä» 1 å¼€å§‹çš„åºå·
</span></span></span><span class="line"><span class="ln"> 73</span><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">os</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 74</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">
</span></span><span class="line"><span class="ln"> 76</span><span class="cl"><span class="c1">// å°è¯•ç§»åŠ¨åœ¨ç‚¹ from ä¸Šçš„ç‰©ä½“(æœºå™¨äººæˆ–è€…çŸ³å¤´)
</span></span></span><span class="line"><span class="ln"> 77</span><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">tryMove</span><span class="p">(</span><span class="k">const</span> <span class="n">State</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">from</span><span class="p">,</span> <span class="n">queue</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">q</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">    <span class="kt">int</span> <span class="n">rp</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">getP</span><span class="p">();</span> <span class="c1">// è·å–å½“å‰çŠ¶æ€ä¸‹æœºå™¨äººçš„ä½ç½®ç¼–å·
</span></span></span><span class="line"><span class="ln"> 79</span><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">to</span> <span class="p">:</span> <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="n">to</span> <span class="o">==</span> <span class="n">rp</span><span class="p">)</span> <span class="o">||</span> <span class="n">s</span><span class="p">[</span><span class="n">to</span><span class="p">])</span> <span class="c1">// to å’Œå½“å‰çŠ¶æ€çš„æœºå™¨äººä½ç½®é‡åˆæˆ–è€… to çš„ä½ç½®ä¸Šæœ‰æœºå™¨äºº
</span></span></span><span class="line"><span class="ln"> 81</span><span class="cl"><span class="c1"></span>            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">        <span class="kt">int</span> <span class="n">ng</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">g</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="o">==</span> <span class="n">rp</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">            <span class="n">ng</span> <span class="o">=</span> <span class="p">((</span><span class="n">s</span><span class="p">.</span><span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">to</span><span class="p">;</span> <span class="c1">// æŠŠ s.g çš„å‰ 4 ä½ç½®æˆ to è¿™ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯ç§»åŠ¨æœºå™¨äººåˆ° to çš„ä½ç½®
</span></span></span><span class="line"><span class="ln"> 85</span><span class="cl"><span class="c1"></span>        <span class="k">else</span>
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">            <span class="n">ng</span> <span class="o">^=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">from</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)),</span> <span class="n">ng</span> <span class="o">^=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">to</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span> <span class="c1">// æŠŠ ng çš„ from å¯¹åº”çš„ bit ä½ç½® 0ï¼Œç„¶åæŠŠ to å¯¹åº”çš„ bit ä½ç½® 1ï¼Œä¹Ÿå°±æ˜¯æŠŠçŸ³å¤´ä» from ä½ç½®ç§»åŠ¨åˆ° to è¿™ä¸ªä½ç½®
</span></span></span><span class="line"><span class="ln"> 87</span><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">VIS</span><span class="p">[</span><span class="n">ng</span><span class="p">])</span>
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">            <span class="k">continue</span><span class="p">;</span> <span class="c1">// æ–°çš„çŠ¶æ€å·²ç»è®¿é—®è¿‡
</span></span></span><span class="line"><span class="ln"> 89</span><span class="cl"><span class="c1"></span>        <span class="n">VIS</span><span class="p">[</span><span class="n">ng</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">// æ ‡è®°è®¿é—®
</span></span></span><span class="line"><span class="ln"> 90</span><span class="cl"><span class="c1"></span>        <span class="c1">// è¿™é‡Œæ„å»ºçš„æ–° State çš„ newNode çš„ next å±æ€§æŒ‡å‘çš„æ˜¯ç§»åŠ¨å‰çš„ State çš„ path Node
</span></span></span><span class="line"><span class="ln"> 91</span><span class="cl"><span class="c1"></span>        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">State</span><span class="p">(</span><span class="n">ng</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">newNode</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">path</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">)));</span>
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 93</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">
</span></span><span class="line"><span class="ln"> 95</span><span class="cl"><span class="c1">// bfs
</span></span></span><span class="line"><span class="ln"> 96</span><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">    <span class="c1">// å®šä¹‰å¹¶åˆå§‹åŒ–åŸå§‹çš„çŠ¶æ€
</span></span></span><span class="line"><span class="ln"> 98</span><span class="cl"><span class="c1"></span>    <span class="n">State</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">    <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="n">s</span><span class="p">.</span><span class="n">setRock</span><span class="p">(</span><span class="n">O</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl">    <span class="n">s</span><span class="p">.</span><span class="n">setP</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl">    <span class="n">queue</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">102</span><span class="cl">    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">103</span><span class="cl">    <span class="n">VIS</span><span class="p">[</span><span class="n">s</span><span class="p">.</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// æ ‡è®°å½“å‰æœºå™¨äººå’ŒçŸ³å¤´çš„çŠ¶æ€å·²ç»è¢«è®¿é—®è¿‡
</span></span></span><span class="line"><span class="ln">104</span><span class="cl"><span class="c1"></span>    <span class="c1">// bfs ä¸€å±‚ä¸€å±‚åœ°éå†
</span></span></span><span class="line"><span class="ln">105</span><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">106</span><span class="cl">        <span class="k">const</span> <span class="n">State</span> <span class="o">&amp;</span><span class="n">st</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">107</span><span class="cl">        <span class="kt">int</span> <span class="n">rp</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">getP</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">108</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">rp</span> <span class="o">==</span> <span class="n">T</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// åˆ°è¾¾ç›®çš„åœ°ï¼Œå› ä¸ºæ˜¯ bfsï¼Œæ‰€ä»¥ä¸€æ—¦åˆ°è¾¾ç›®çš„åœ°ï¼Œä¹Ÿå°±è¡¨æ˜æ˜¯æœ€çŸ­è·¯å¾„ä¹‹ä¸€ï¼Œåé¢ä¸å¯èƒ½æœ‰ç§»åŠ¨æ­¥æ•°æ›´å°‘çš„ç»“æœï¼Œæœ€å¥½çš„æƒ…å†µä¹Ÿæ˜¯èŠ±è´¹å’Œå½“å‰ä¸€æ ·çš„æ­¥æ•°
</span></span></span><span class="line"><span class="ln">109</span><span class="cl"><span class="c1"></span>            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">st</span><span class="p">.</span><span class="n">len</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">st</span><span class="p">.</span><span class="n">path</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">110</span><span class="cl">            <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">112</span><span class="cl">        <span class="n">tryMove</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">rp</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>                         <span class="c1">// å°è¯•ç§»åŠ¨æœºå™¨äºº
</span></span></span><span class="line"><span class="ln">113</span><span class="cl"><span class="c1"></span>        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">tryMove</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="c1">// å°è¯•ç§»åŠ¨çŸ³å¤´
</span></span></span><span class="line"><span class="ln">114</span><span class="cl"><span class="c1"></span>        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">116</span><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;-1&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="c1">// æ— æ³•åˆ°è¾¾ç›®çš„åœ°
</span></span></span><span class="line"><span class="ln">117</span><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="ln">118</span><span class="cl">
</span></span><span class="line"><span class="ln">119</span><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">120</span><span class="cl">    <span class="c1">// é‡å®šå‘æ ‡å‡†è¾“å…¥åˆ°æ–‡ä»¶
</span></span></span><span class="line"><span class="ln">121</span><span class="cl"><span class="c1"></span>    <span class="n">string</span> <span class="n">relativePathToCurrentCppFile</span> <span class="o">=</span> <span class="s">&#34;./data/UVa12569/input1.txt&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl">    <span class="c1">// relativePathToCurrentCppFile = &#34;./data/UVa12569/input2.txt&#34;;
</span></span></span><span class="line"><span class="ln">123</span><span class="cl"><span class="c1"></span>    <span class="c1">// å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œç¼–è¯‘å‡ºæ¥çš„å¯æ‰§è¡Œæ–‡ä»¶çš„
</span></span></span><span class="line"><span class="ln">124</span><span class="cl"><span class="c1"></span>    <span class="n">ifstream</span> <span class="n">inputFile</span><span class="p">(</span><span class="s">&#34;./ch07&#34;</span> <span class="o">+</span> <span class="n">relativePathToCurrentCppFile</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">relativePathToCurrentCppFile</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">125</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">inputFile</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl">        <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Failed to open input data file.&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">        <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">129</span><span class="cl">    <span class="n">streambuf</span> <span class="o">*</span><span class="n">cinbuf</span> <span class="o">=</span> <span class="n">cin</span><span class="p">.</span><span class="n">rdbuf</span><span class="p">();</span> <span class="c1">// save original buf
</span></span></span><span class="line"><span class="ln">130</span><span class="cl"><span class="c1"></span>    <span class="n">cin</span><span class="p">.</span><span class="n">rdbuf</span><span class="p">(</span><span class="n">inputFile</span><span class="p">.</span><span class="n">rdbuf</span><span class="p">());</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl">
</span></span><span class="line"><span class="ln">132</span><span class="cl">    <span class="kt">int</span> <span class="n">K</span> <span class="o">=</span> <span class="n">readint</span><span class="p">();</span> <span class="c1">// è¯»å– case çš„æ•°é‡ï¼Œä¸ºäº†å’Œ case å…³é”®å­—åŒºåˆ†ï¼Œä¸€èˆ¬ç”¨ Kase æˆ–è€… K æ¥è¡¨ç¤º case
</span></span></span><span class="line"><span class="ln">133</span><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">K</span><span class="p">;</span> <span class="n">t</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">134</span><span class="cl">        <span class="n">memset</span><span class="p">(</span><span class="n">VIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">VIS</span><span class="p">));</span> <span class="c1">// åˆå§‹åŒ–ç½® 0
</span></span></span><span class="line"><span class="ln">135</span><span class="cl"><span class="c1"></span>        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>     <span class="c1">// è¯»å…¥ n m S T
</span></span></span><span class="line"><span class="ln">136</span><span class="cl"><span class="c1"></span>        <span class="o">--</span><span class="n">S</span><span class="p">;</span>                         <span class="c1">// ç¨‹åºç”¨åˆ°çš„ç¼–å·è¦å‡ 1
</span></span></span><span class="line"><span class="ln">137</span><span class="cl"><span class="c1"></span>        <span class="o">--</span><span class="n">T</span><span class="p">;</span>                         <span class="c1">// åŒä¸Š
</span></span></span><span class="line"><span class="ln">138</span><span class="cl"><span class="c1"></span>        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Case &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">t</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;: &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">139</span><span class="cl">        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="n">O</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">readint</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// è¯»å…¥çŸ³å¤´çš„ç¼–å·ï¼Œç¼–å·æ˜¯ä»ç»™çš„æ•°æ®å‡ 1 è€Œå¾—æ¥
</span></span></span><span class="line"><span class="ln">140</span><span class="cl"><span class="c1"></span>        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>         <span class="c1">// æ¸…é™¤ä¹‹å‰çš„æ•°æ®
</span></span></span><span class="line"><span class="ln">141</span><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="ln">142</span><span class="cl">        <span class="c1">// æ„å»ºé‚»æ¥çŸ©é˜µ
</span></span></span><span class="line"><span class="ln">143</span><span class="cl"><span class="c1"></span>        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>                           <span class="c1">// è¯»å…¥ n - 1 æ¡è¾¹
</span></span></span><span class="line"><span class="ln">144</span><span class="cl"><span class="c1"></span>            <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">readint</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">readint</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// æ¯ä¸€ä¸ªé¡¶ç‚¹çš„ç¼–å·éƒ½è¦å‡ 1
</span></span></span><span class="line"><span class="ln">145</span><span class="cl"><span class="c1"></span>            <span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">146</span><span class="cl">            <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">147</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">148</span><span class="cl">
</span></span><span class="line"><span class="ln">149</span><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">150</span><span class="cl">        <span class="n">pool</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span> <span class="c1">// é‡Šæ”¾å†…å­˜
</span></span></span><span class="line"><span class="ln">151</span><span class="cl"><span class="c1"></span>        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">152</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">153</span><span class="cl">
</span></span><span class="line"><span class="ln">154</span><span class="cl">    <span class="c1">// æ¢å¤æ ‡å‡†è¾“å…¥
</span></span></span><span class="line"><span class="ln">155</span><span class="cl"><span class="c1"></span>    <span class="n">cin</span><span class="p">.</span><span class="n">rdbuf</span><span class="p">(</span><span class="n">cinbuf</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">156</span><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">157</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="çº¯å‡€çš„ä»£ç ">çº¯å‡€çš„ä»£ç <a hidden class="anchor" aria-hidden="true" href="#çº¯å‡€çš„ä»£ç ">#</a></h2>
<p>ç”±äºä¸Šé¢çš„ä»£ç æˆ‘ä¸ºäº†è‡ªå·±æµ‹è¯•æ–¹ä¾¿è¿›è¡Œæ ‡å‡†è¾“å…¥æµé‡å®šå‘çš„å¤„ç†ï¼Œæ˜¯ä¸èƒ½ç›´æ¥æäº¤çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘åœ¨ä¸‹é¢æä¾›ä¸€ä»½çº¯å‡€çš„å¯ä»¥ç”¨äºæäº¤éªŒè¯çš„ä»£ç ï¼Œè¿™é‡ŒåŒæ—¶å»é™¤äº†æ‰€æœ‰çš„æ³¨é‡Šï¼Œå› ä¸ºä¸­æ–‡å­—ç¬¦ä¼¼ä¹ä¸è¢«æ¥å—ï¼Œ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="ln">  1</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="cp">#define _for(i, a, b) for (int i = (a); i &lt; (b); ++i)
</span></span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 10</span><span class="cl">
</span></span><span class="line"><span class="ln"> 11</span><span class="cl"><span class="kt">int</span> <span class="nf">readint</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 12</span><span class="cl">    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 13</span><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 14</span><span class="cl">    <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 16</span><span class="cl">
</span></span><span class="line"><span class="ln"> 17</span><span class="cl"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span> <span class="k">struct</span> <span class="nc">MemPool</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 18</span><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span> <span class="o">*&gt;</span> <span class="n">buf</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 19</span><span class="cl">    <span class="n">T</span> <span class="o">*</span><span class="nf">createNew</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">        <span class="n">buf</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">new</span> <span class="n">T</span><span class="p">());</span>
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">        <span class="k">return</span> <span class="n">buf</span><span class="p">.</span><span class="n">back</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 23</span><span class="cl">
</span></span><span class="line"><span class="ln"> 24</span><span class="cl">    <span class="kt">void</span> <span class="nf">dispose</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 25</span><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">buf</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">            <span class="k">delete</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">        <span class="n">buf</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 29</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">
</span></span><span class="line"><span class="ln"> 31</span><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">
</span></span><span class="line"><span class="ln"> 33</span><span class="cl"><span class="k">struct</span> <span class="nc">Node</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">    <span class="kt">int</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">    <span class="n">Node</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 36</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">
</span></span><span class="line"><span class="ln"> 38</span><span class="cl"><span class="k">struct</span> <span class="nc">State</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">    <span class="n">Node</span> <span class="o">*</span><span class="n">path</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">    <span class="kt">int</span> <span class="n">g</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 41</span><span class="cl">    <span class="kt">int</span> <span class="n">len</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">    <span class="n">State</span><span class="p">(</span><span class="kt">int</span> <span class="n">gi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">li</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Node</span> <span class="o">*</span><span class="n">pn</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">:</span> <span class="n">g</span><span class="p">(</span><span class="n">gi</span><span class="p">),</span> <span class="n">len</span><span class="p">(</span><span class="n">li</span><span class="p">),</span> <span class="n">path</span><span class="p">(</span><span class="n">pn</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">    <span class="kr">inline</span> <span class="kt">bool</span> <span class="k">operator</span><span class="p">[](</span><span class="n">size_t</span> <span class="n">i</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">g</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">    <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">setRock</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">val</span> <span class="o">=</span> <span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">            <span class="n">g</span> <span class="o">|=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">            <span class="n">g</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">    <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">getP</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">g</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">    <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">setP</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span> <span class="n">g</span> <span class="o">=</span> <span class="p">((</span><span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">p</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 53</span><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">
</span></span><span class="line"><span class="ln"> 55</span><span class="cl"><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">G</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 56</span><span class="cl"><span class="n">MemPool</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">pool</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">
</span></span><span class="line"><span class="ln"> 58</span><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">O</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">VIS</span><span class="p">[</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">19</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 59</span><span class="cl"><span class="n">Node</span> <span class="o">*</span><span class="nf">newNode</span><span class="p">(</span><span class="n">Node</span> <span class="o">*</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span> <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">    <span class="n">Node</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">pool</span><span class="p">.</span><span class="n">createNew</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">    <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">next</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">from</span> <span class="o">=</span> <span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">to</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl">    <span class="k">return</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 63</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">
</span></span><span class="line"><span class="ln"> 65</span><span class="cl"><span class="n">ostream</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">os</span><span class="p">,</span> <span class="n">Node</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">        <span class="k">return</span> <span class="n">os</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">    <span class="n">os</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">from</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">to</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">    <span class="k">return</span> <span class="n">os</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">
</span></span><span class="line"><span class="ln"> 72</span><span class="cl"><span class="kt">void</span> <span class="nf">tryMove</span><span class="p">(</span><span class="k">const</span> <span class="n">State</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">from</span><span class="p">,</span> <span class="n">queue</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">q</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">    <span class="kt">int</span> <span class="n">rp</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">getP</span><span class="p">();</span>
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">to</span> <span class="p">:</span> <span class="n">G</span><span class="p">[</span><span class="n">from</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">        <span class="k">if</span> <span class="p">((</span><span class="n">to</span> <span class="o">==</span> <span class="n">rp</span><span class="p">)</span> <span class="o">||</span> <span class="n">s</span><span class="p">[</span><span class="n">to</span><span class="p">])</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">        <span class="kt">int</span> <span class="n">ng</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">g</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">from</span> <span class="o">==</span> <span class="n">rp</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 79</span><span class="cl">            <span class="n">ng</span> <span class="o">=</span> <span class="p">((</span><span class="n">s</span><span class="p">.</span><span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">            <span class="n">ng</span> <span class="o">^=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">from</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)),</span> <span class="n">ng</span> <span class="o">^=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">to</span> <span class="o">+</span> <span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">VIS</span><span class="p">[</span><span class="n">ng</span><span class="p">])</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">        <span class="n">VIS</span><span class="p">[</span><span class="n">ng</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">        <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">State</span><span class="p">(</span><span class="n">ng</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">newNode</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">path</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">)));</span>
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 88</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">
</span></span><span class="line"><span class="ln"> 90</span><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">    <span class="n">State</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">    <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="n">s</span><span class="p">.</span><span class="n">setRock</span><span class="p">(</span><span class="n">O</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">    <span class="n">s</span><span class="p">.</span><span class="n">setP</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">    <span class="n">queue</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">    <span class="n">VIS</span><span class="p">[</span><span class="n">s</span><span class="p">.</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl">        <span class="k">const</span> <span class="n">State</span> <span class="o">&amp;</span><span class="n">st</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl">        <span class="kt">int</span> <span class="n">rp</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">getP</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">102</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">rp</span> <span class="o">==</span> <span class="n">T</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">103</span><span class="cl">            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">st</span><span class="p">.</span><span class="n">len</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">st</span><span class="p">.</span><span class="n">path</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">104</span><span class="cl">            <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">105</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">106</span><span class="cl">        <span class="n">tryMove</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">rp</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">107</span><span class="cl">        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">tryMove</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">108</span><span class="cl">        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">109</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">110</span><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;-1&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="ln">112</span><span class="cl">
</span></span><span class="line"><span class="ln">113</span><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">114</span><span class="cl">    <span class="kt">int</span> <span class="n">K</span> <span class="o">=</span> <span class="n">readint</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">K</span><span class="p">;</span> <span class="n">t</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">116</span><span class="cl">        <span class="n">memset</span><span class="p">(</span><span class="n">VIS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">VIS</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">117</span><span class="cl">        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">S</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">118</span><span class="cl">        <span class="o">--</span><span class="n">S</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">119</span><span class="cl">        <span class="o">--</span><span class="n">T</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">120</span><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Case &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">t</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;: &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">121</span><span class="cl">        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="n">O</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">readint</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl">        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">123</span><span class="cl">
</span></span><span class="line"><span class="ln">124</span><span class="cl">        <span class="n">_for</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">125</span><span class="cl">            <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">readint</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">readint</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl">            <span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">            <span class="n">G</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">129</span><span class="cl">
</span></span><span class="line"><span class="ln">130</span><span class="cl">        <span class="n">solve</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl">        <span class="n">pool</span><span class="p">.</span><span class="n">dispose</span><span class="p">();</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">134</span><span class="cl">
</span></span><span class="line"><span class="ln">135</span><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">136</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><img loading="lazy" src="https://i.postimg.cc/ZYpk0djw/image.png"></p>
<p>å½“ç„¶ï¼Œè¿™ä¸ªä»£ç ä¹Ÿæ˜¯å¯ä»¥åœ¨æˆ‘çš„ GitHub ä»“åº“ä¸­æ‰¾åˆ°çš„ã€‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ<a hidden class="anchor" aria-hidden="true" href="#å‚è€ƒ">#</a></h2>
<p>1ã€ã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸ã€‹ç¬¬äºŒç‰ˆ<br>
2ã€<a href="https://github.com/sukhoeing/aoapc-bac2nd-keys">https://github.com/sukhoeing/aoapc-bac2nd-keys</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/bilibili/">Bilibili</a></li>
      <li><a href="http://localhost:1313/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/">ç®—æ³•ç«èµ›</a></li>
      <li><a href="http://localhost:1313/tags/uva/">UVa</a></li>
      <li><a href="http://localhost:1313/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E5%85%A5%E9%97%A8%E7%BB%8F%E5%85%B8/">ç®—æ³•ç«èµ›å…¥é—¨ç»å…¸</a></li>
      <li><a href="http://localhost:1313/tags/bfs/">BFS</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/is-arch-kde-wayland-good-for-daily-use/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>Arch Linux KDE é€‚åˆæˆ‘ä»¬ä½œä¸ºä¸€ä¸ªæ—¥å¸¸çš„æ“ä½œç³»ç»Ÿå»ä½¿ç”¨å—ï¼Ÿ</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/personal-likes-terminal-and-shell-in-windows/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>ç»ˆç«¯å’Œ Shell çš„ä½¿ç”¨ä¹‹ Windows ç¯‡</span>
  </a>
</nav>

  </footer><div id="tw-comment"></div>
<script>
    
    const getStoredTheme = () => localStorage.getItem("pref-theme") === "light" ? "light" : "dark";
    const setGiscusTheme = () => {
        const sendMessage = (message) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app');
            }
        }
        sendMessage({setConfig: {theme: getStoredTheme()}})
    }

    document.addEventListener("DOMContentLoaded", () => {
        const giscusAttributes = {
            "src": "https://giscus.app/client.js",
            "data-repo": "sonnycalcr\/sonnycalcr.github.io",
            "data-repo-id": "R_kgDOMed_Fg",
            "data-category": "Announcements",
            "data-category-id": "DIC_kwDOMed_Fs4ChXJF",
            "data-mapping": "pathname",
            "data-strict": "0",
            "data-reactions-enabled": "1",
            "data-emit-metadata": "0",
            "data-input-position": "bottom",
            "data-theme": getStoredTheme(),
            "data-lang": "zh-CN",
            "data-loading": "lazy",
            "crossorigin": "anonymous",
        };

        
        const giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
        document.querySelector("#tw-comment").appendChild(giscusScript);

        
        const themeSwitcher = document.querySelector("#theme-toggle");
        if (themeSwitcher) {
            themeSwitcher.addEventListener("click", setGiscusTheme);
        }
        const themeFloatSwitcher = document.querySelector("#theme-toggle-float");
        if (themeFloatSwitcher) {
            themeFloatSwitcher.addEventListener("click", setGiscusTheme);
        }
    });
</script>

</article>
    </main>
    
<footer class="footer">
        <span><a href="https://sonnycalcr.github.io/">Â©2024 SonnyCalcr&rsquo;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>


<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js"
  integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj+Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
  var OSName = "unknown";
  var navApp = navigator.userAgent.toLowerCase();
  switch (true) {
    case (navApp.indexOf("win") != -1):
      OSName = "windows";
      break;
    case (navApp.indexOf("mac") != -1):
      OSName = "apple";
      break;
    case (navApp.indexOf("linux") != -1):
      OSName = "linux";
      break;
    case (navApp.indexOf("x11") != -1):
      OSName = "unix";
      break;
  }

  const images = Array.from(document.querySelectorAll(".post-content img"));
  images.forEach(img => {
    mediumZoom(img, {
      margin: 1,    
      
      container: null,  
      template: null,  
      
    });
  });

  if (OSName == "windows") {
    document.body.className += ' win11'
  }
</script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
